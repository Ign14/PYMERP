import{j as e,k as A,c as T,V as se,q as ae,W as re,X as Y,m as ne,u as J,Y as le,Z as ie,_ as oe,$ as de,a0 as ce,a1 as D,a2 as me,a3 as ue,a4 as q,a5 as B,a6 as xe,a7 as he}from"./index-C0DCX_lx.js";import{r as N,L as ge,d as X}from"./react-DFcFNn96.js";import{u as C}from"./useQuery-ClGZjTlq.js";import{P as be}from"./PageHeader-ZA88au4Z.js";import pe from"./LocationsPage-Bif2xA1M.js";import _ from"./LotsListPage-DjIxIjd3.js";import{g as je,a as Ne}from"./inventory-DjR51aUj.js";import{M as F}from"./Modal-BfA53Mfc.js";import{c as R}from"./currency-HwQAg_Xa.js";import{R as $,B as O,C as U,X as z,Y as K,T as Q,a as V,g as L,f as Z}from"./charts-CIawE-G5.js";function W(t){return`"${t.replace(/"/g,'""')}"`}function fe({filename:t,fields:s,data:x,disabled:d,className:l,children:o}){const a=s.map(h=>W(h.label)).join(","),i=h=>{if(h.preventDefault(),d)return;const m=x.map(r=>s.map(f=>{const j=r[f.key],v=f.format?f.format(j,r):j,b=v==null?"":String(v);return W(b)}).join(",")),p=[a,...m].join(`\r
`),c=new Blob([p],{type:"text/csv;charset=utf-8;"}),g=URL.createObjectURL(c),n=document.createElement("a");n.href=g,n.download=t,n.click(),URL.revokeObjectURL(g)};return e.jsx("button",{className:`btn ghost small ${l??""}`.trim(),type:"button",onClick:i,disabled:d,children:o??"Exportar CSV"})}const ve=[{value:"",label:"Todos los tipos"},{value:"PURCHASE_IN",label:"Compras"},{value:"SALE_OUT",label:"Ventas"},{value:"ADJUSTMENT",label:"Ajustes"},{value:"TRANSFER",label:"Transferencias"}],ye=12,Ce={PURCHASE_IN:"#10b981",SALE_OUT:"#ef4444",ADJUSTMENT:"#f59e0b",TRANSFER:"#3b82f6"};function Se(){const[t,s]=N.useState({type:"",productId:"",lotId:"",dateFrom:"",dateTo:"",page:0}),x=C({queryKey:["inventory-movements",t.type,t.productId,t.lotId,t.dateFrom,t.dateTo,t.page],queryFn:()=>je({type:t.type||void 0,productId:t.productId||void 0,lotId:t.lotId||void 0,dateFrom:t.dateFrom?new Date(t.dateFrom).toISOString():void 0,dateTo:t.dateTo?new Date(t.dateTo).toISOString():void 0,page:t.page,size:ye,sort:"createdAt,desc"}),keepPreviousData:!0}),d=C({queryKey:["inventory-movement-products"],queryFn:()=>A({size:200,status:"all"}),staleTime:6e4}),l=N.useMemo(()=>{const r=d.data?.content??[];return new Map(r.map(f=>[f.id,f]))},[d.data]),o=x.data?.content??[],a=x.data?.totalPages??1,i=(r,f)=>{s(j=>({...j,[r]:f,page:0}))},h=()=>{s(r=>({...r,page:Math.max(0,r.page-1)}))},m=()=>{s(r=>({...r,page:Math.min(a-1,r.page+1)}))},p=r=>new Date(r).toLocaleString("es-CL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),c=r=>r==null?"â€”":r.toLocaleString("es-CL"),g=(r,f)=>{if(!r||!f)return;const j=r.toLowerCase();return j.includes("purchase")?`/app/purchases/${f}`:j.includes("sale")?`/app/sales/${f}`:j.includes("adjust")?`/app/inventory/adjustments/${f}`:j.includes("transfer")?`/app/inventory/transfers/${f}`:`/app/inventory/movements/${f}`},n=[{key:"createdAt",label:"Fecha",format:r=>p(String(r))},{key:"type",label:"Tipo"},{key:"productId",label:"Producto",format:r=>l.get(String(r??""))?.name??String(r??"â€”")},{key:"lotId",label:"Lote"},{key:"qtyChange",label:"Î”Cantidad",format:r=>r==null?"":String(r)},{key:"beforeQty",label:"Antes",format:r=>c(r)},{key:"afterQty",label:"DespuÃ©s",format:r=>c(r)},{key:"refType",label:"Referencia",format:(r,f)=>`${r??"â€”"} ${f.refId?String(f.refId).substring(0,8):""}`.trim()}];return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Historial de Movimientos (AuditorÃ­a)"}),e.jsx("p",{className:"muted small",children:"Registra cada entrada y salida de stock para mantener trazabilidad y auditorÃ­a."})]}),e.jsx("div",{className:"inline-actions",children:e.jsx(fe,{filename:"movimientos-inventario.csv",fields:n,data:o,disabled:o.length===0})})]}),e.jsx("div",{className:"card-body",style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:e.jsxs("div",{className:"inline-actions",style:{flexWrap:"wrap",gap:"0.75rem"},children:[e.jsx("select",{className:"input",value:t.type,onChange:r=>i("type",r.target.value),children:ve.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))}),e.jsxs("select",{className:"input",value:t.productId,onChange:r=>i("productId",r.target.value),children:[e.jsx("option",{value:"",children:"Todos los productos"}),Array.from(l.values()).map(r=>e.jsxs("option",{value:r.id,children:[r.sku," Â· ",r.name]},r.id))]}),e.jsx("input",{className:"input",placeholder:"Filtrar por lote...",value:t.lotId,onChange:r=>i("lotId",r.target.value)}),e.jsxs("label",{className:"small",children:["Desde",e.jsx("input",{type:"date",className:"input",value:t.dateFrom,onChange:r=>i("dateFrom",r.target.value)})]}),e.jsxs("label",{className:"small",children:["Hasta",e.jsx("input",{type:"date",className:"input",value:t.dateTo,onChange:r=>i("dateTo",r.target.value)})]})]})}),x.isLoading?e.jsx("p",{className:"muted",children:"Cargando movimientosâ€¦"}):x.isError?e.jsx("p",{className:"error",children:x.error?.message??"No se pudieron cargar los movimientos"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Fecha"}),e.jsx("th",{children:"Tipo"}),e.jsx("th",{children:"Producto"}),e.jsx("th",{children:"Lote"}),e.jsx("th",{children:"Î”Cantidad"}),e.jsx("th",{children:"Antes / DespuÃ©s"}),e.jsx("th",{children:"UbicaciÃ³n"}),e.jsx("th",{children:"Usuario"}),e.jsx("th",{children:"TraceId"}),e.jsx("th",{children:"Referencia"})]})}),e.jsx("tbody",{children:o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"muted",children:"NingÃºn movimiento coincide con los filtros aplicados."})}):o.map(r=>{const f=l.get(r.productId??""),j=g(r.refType,r.refId??void 0),v=r.locationFrom?.name??r.locationFrom?.id,b=r.locationTo?.name??r.locationTo?.id,S=v&&b?`${v} â†’ ${b}`:v||b||"â€”",u=r.qtyChange>0?"+":"",y=`${c(r.beforeQty)} â†’ ${c(r.afterQty)}`;return e.jsxs("tr",{children:[e.jsx("td",{className:"mono small",children:p(r.createdAt)}),e.jsx("td",{children:e.jsx("span",{style:{color:Ce[r.type]??"#6b7280",fontWeight:600,fontSize:"0.85rem"},children:r.type})}),e.jsxs("td",{children:[f?.name??r.productId??"â€”",e.jsx("div",{className:"muted small",children:f?.sku?`SKU: ${f.sku}`:r.productId??""})]}),e.jsx("td",{className:"mono small",children:r.lotId??"â€”"}),e.jsx("td",{className:"mono",children:e.jsxs("span",{style:{color:r.qtyChange>0?"#10b981":"#ef4444",fontWeight:600},children:[u,r.qtyChange.toLocaleString("es-CL")]})}),e.jsx("td",{className:"mono small",children:y}),e.jsx("td",{className:"small",children:S}),e.jsx("td",{className:"small",children:r.userId??r.traceId??"â€”"}),e.jsx("td",{className:"mono small",children:r.traceId??"â€”"}),e.jsx("td",{className:"mono small",children:j&&r.refId?e.jsxs(ge,{to:j,children:[r.refType," Â· ",r.refId.substring(0,8)]}):r.refType?`${r.refType} Â· ${r.refId}`:"â€”"})]},r.id)})})]})}),e.jsxs("div",{className:"pagination",style:{marginTop:"1rem"},children:[e.jsx("button",{className:"btn ghost",disabled:t.page===0,onClick:h,children:"â† Anterior"}),e.jsxs("span",{className:"muted",children:["PÃ¡gina ",t.page+1," de ",a]}),e.jsx("button",{className:"btn ghost",disabled:t.page>=a-1,onClick:m,children:"Siguiente â†’"})]})]}),e.jsx("div",{className:"muted small",style:{marginTop:"0.5rem"},children:"TraceId permite reconstruir auditorÃ­as completas; referencia se enlaza a la operaciÃ³n relacionada."})]})}const E={productId:"",direction:"increase",quantity:"0",unitCost:"0",reason:"",expDate:""};function we({open:t,onClose:s,onApplied:x}){const[d,l]=N.useState(E);N.useEffect(()=>{t||l(E)},[t]);const o=C({queryKey:["products",{dialog:"inventory-adjustment"}],queryFn:()=>A({size:200,status:"all"}),enabled:t}),a=N.useMemo(()=>o.data?.content??[],[o.data]),i=T({mutationFn:()=>{if(!d.productId)throw new Error("Selecciona un producto");const m=Number(d.quantity);if(!Number.isFinite(m)||m<=0)throw new Error("La cantidad debe ser mayor a cero");const p=d.direction,c=Number(d.unitCost||0);if(p==="increase"&&(Number.isNaN(c)||c<0))throw new Error("El costo unitario debe ser positivo");const g={productId:d.productId,quantity:m,direction:p,reason:d.reason.trim()||"Ajuste manual",unitCost:p==="increase"?c:void 0,expDate:d.expDate||void 0};return se(g)},onSuccess:()=>{x?.(),l(E),s()}}),h=m=>{m.preventDefault(),!i.isPending&&i.mutate()};return e.jsx(F,{open:t,title:"Ajuste de stock",onClose:()=>{i.isPending||s()},children:e.jsxs("form",{className:"form-grid",onSubmit:h,children:[e.jsxs("label",{children:[e.jsx("span",{children:"Producto *"}),e.jsxs("select",{className:"input",value:d.productId,onChange:m=>l(p=>({...p,productId:m.target.value})),disabled:i.isPending,required:!0,children:[e.jsx("option",{value:"",children:"Selecciona un producto"}),a.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]}),e.jsxs("label",{children:[e.jsx("span",{children:"Tipo de ajuste"}),e.jsxs("select",{className:"input",value:d.direction,onChange:m=>l(p=>({...p,direction:m.target.value})),disabled:i.isPending,children:[e.jsx("option",{value:"increase",children:"Incremento"}),e.jsx("option",{value:"decrease",children:"Disminucion"})]})]}),e.jsxs("label",{children:[e.jsx("span",{children:"Cantidad *"}),e.jsx("input",{className:"input",type:"number",min:"0",step:"0.01",value:d.quantity,onChange:m=>l(p=>({...p,quantity:m.target.value})),disabled:i.isPending,required:!0})]}),d.direction==="increase"&&e.jsxs("label",{children:[e.jsx("span",{children:"Costo unitario"}),e.jsx("input",{className:"input",type:"number",min:"0",step:"0.01",value:d.unitCost,onChange:m=>l(p=>({...p,unitCost:m.target.value})),disabled:i.isPending})]}),e.jsxs("label",{children:[e.jsx("span",{children:"Fecha de vencimiento"}),e.jsx("input",{className:"input",type:"date",value:d.expDate,onChange:m=>l(p=>({...p,expDate:m.target.value})),disabled:i.isPending})]}),e.jsxs("label",{children:[e.jsx("span",{children:"Motivo"}),e.jsx("textarea",{className:"input",rows:3,value:d.reason,onChange:m=>l(p=>({...p,reason:m.target.value})),placeholder:"Regularizacion, inventario, merma, etc.",disabled:i.isPending})]}),i.isError&&e.jsx("p",{className:"error",children:i.error?.message??"No se pudo registrar el ajuste"}),e.jsxs("div",{className:"buttons",children:[e.jsx("button",{className:"btn",type:"submit",disabled:i.isPending,children:i.isPending?"Guardando...":"Registrar"}),e.jsx("button",{className:"btn ghost",type:"button",onClick:s,disabled:i.isPending,children:"Cancelar"})]})]})})}const ke=3,Pe=1e3*60*5,Ae=1e3*60*30;function ee(t){return Number.isFinite(t)?Number.isInteger(t)?t.toLocaleString("es-CL"):t.toLocaleString("es-CL",{maximumFractionDigits:2}):"0"}function Fe(t){if(t.length===0)return"";const s="Ubicaciones adicionales:",x=t.map(d=>`${d.locationName}: ${ee(d.availableQty)}`);return[s,...x].join(`
`)}function Ie({productId:t,enabled:s=!0,displayLimit:x=ke}){const d=Math.max(0,Math.floor(x)),l=C({queryKey:["inventory","stockByProduct",t],queryFn:()=>Ne(t),enabled:!!t&&s,staleTime:Pe,cacheTime:Ae}),o=N.useMemo(()=>(l.data??[]).filter(m=>m.availableQty>0),[l.data]),a=N.useMemo(()=>o.slice(0,d),[o,d]),i=N.useMemo(()=>d>=o.length?[]:o.slice(d),[o,d]);return a.length===0&&i.length===0?null:e.jsxs("div",{className:"product-stock-chips","aria-live":"polite",children:[a.map(h=>e.jsxs("span",{className:"product-stock-chip","data-testid":"product-stock-chip",children:[e.jsx("span",{className:"product-stock-chip__label",children:`${h.locationName}: `}),e.jsx("span",{className:"product-stock-chip__value",children:ee(h.availableQty)})]},h.locationId)),i.length>0&&e.jsxs("span",{className:"product-stock-chip product-stock-chip--overflow","data-testid":"product-stock-chip-overflow",title:Fe(i),"aria-label":`${i.length} ubicaciones adicionales con stock`,children:["+",i.length]})]})}const Le="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20160%20160'%20role='img'%20aria-label='Producto%20sin%20imagen'%3e%3cdefs%3e%3clinearGradient%20id='bg'%20x1='0%25'%20y1='0%25'%20x2='100%25'%20y2='100%25'%3e%3cstop%20offset='0%25'%20stop-color='%231f2937'%20/%3e%3cstop%20offset='100%25'%20stop-color='%23111827'%20/%3e%3c/linearGradient%3e%3c/defs%3e%3crect%20width='160'%20height='160'%20fill='url(%23bg)'%20rx='24'%20ry='24'%20/%3e%3cpath%20d='M48%2052c0-8.837%207.163-16%2016-16h32c8.837%200%2016%207.163%2016%2016v56c0%208.837-7.163%2016-16%2016H64c-8.837%200-16-7.163-16-16V52zm16-4a12%2012%200%200%200-12%2012v4.382l11.172-11.172a4%204%200%200%201%205.656%200L92%2094.343l10.828-10.828a4%204%200%200%201%205.656%200L112%2086V60a12%2012%200%200%200-12-12H64zm0%2096c-13.255%200-24-10.745-24-24V60c0-13.255%2010.745-24%2024-24h32c13.255%200%2024%2010.745%2024%2024v60c0%2013.255-10.745%2024-24%2024H64z'%20fill='%2360a5fa'%20fill-opacity='0.35'%20/%3e%3ccircle%20cx='64'%20cy='64'%20r='12'%20fill='%23ffffff'%20fill-opacity='0.08'%20/%3e%3c/svg%3e",Te=12;function Ee({open:t,onClose:s,onSelectProduct:x}){const[d,l]=N.useState(""),[o,a]=N.useState(0),[i,h]=N.useState("active"),m=C({queryKey:["products",{q:d,page:o,status:i}],queryFn:()=>A({q:d||void 0,page:o,size:Te,status:i}),placeholderData:ae,enabled:t}),p=m.data?.content??[],c=m.data?.totalPages??1,g=n=>{x(n)};return e.jsx(F,{open:t,onClose:s,title:"CatÃ¡logo de productos",className:"modal-wide",children:e.jsxs("div",{style:{width:"100%",maxWidth:"1000px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"12px",border:"1px solid var(--border-color)"},children:[e.jsx("input",{className:"input",type:"text",placeholder:"ðŸ” Buscar por nombre, SKU o cÃ³digo...",value:d,onChange:n=>{l(n.target.value),a(0)},"data-autofocus":!0,style:{fontSize:"0.95rem"}}),e.jsxs("select",{className:"input",value:i,onChange:n=>{h(n.target.value),a(0)},style:{minWidth:"140px"},children:[e.jsx("option",{value:"active",children:"âœ“ Activos"}),e.jsx("option",{value:"inactive",children:"âœ— Inactivos"}),e.jsx("option",{value:"all",children:"ðŸ“‹ Todos"})]})]}),m.isLoading&&e.jsx("p",{className:"muted",style:{textAlign:"center",padding:"2rem"},children:"Cargando productos..."}),m.isError&&e.jsx("p",{className:"error",style:{textAlign:"center",padding:"2rem"},children:m.error?.message??"No se pudieron cargar los productos"}),!m.isLoading&&p.length===0&&e.jsx("p",{className:"muted",style:{textAlign:"center",padding:"2rem"},children:"No se encontraron productos"}),!m.isLoading&&p.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:"1.25rem",marginBottom:"1.5rem"},children:p.map(n=>{const r=typeof n.imageUrl=="string"&&n.imageUrl.trim().length>0?n.imageUrl:Le,f=n.currentPrice&&Number(n.currentPrice)>0?`$${Number(n.currentPrice).toLocaleString()}`:"Sin precio";return e.jsxs("button",{type:"button",onClick:()=>g(n),className:"product-catalog-card",children:[e.jsxs("div",{className:"product-catalog-card-image-wrapper",children:[e.jsx("img",{src:r,alt:n.name,className:"product-catalog-card-image"}),!n.active&&e.jsx("span",{className:"product-catalog-card-badge-inactive",children:"Inactivo"})]}),e.jsxs("div",{className:"product-catalog-card-content",children:[e.jsx("h4",{className:"product-catalog-card-title",title:n.name,children:n.name}),e.jsx("p",{className:"product-catalog-card-sku",children:n.sku}),e.jsxs("div",{className:"product-catalog-card-footer",children:[e.jsx("span",{className:"product-catalog-card-label",children:"Precio"}),e.jsx("span",{className:"product-catalog-card-price",children:f})]}),n.category&&e.jsx("span",{className:"product-catalog-card-category",title:n.category,children:n.category}),e.jsx(Ie,{productId:n.id,enabled:t})]})]},n.id)})}),c>1&&e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"0.5rem",paddingTop:"1rem",borderTop:"1px solid var(--border-color)"},children:[e.jsx("button",{className:"btn ghost small",onClick:()=>a(n=>Math.max(0,n-1)),disabled:o===0,children:"â€¹ Anterior"}),e.jsxs("span",{className:"muted small",children:["PÃ¡gina ",o+1," de ",c]}),e.jsx("button",{className:"btn ghost small",onClick:()=>a(n=>Math.min(c-1,n+1)),disabled:o>=c-1,children:"Siguiente â€º"})]})]})]})})}const I={targetLocationId:"",qty:"",note:""};function Me({open:t,lot:s,productName:x,onClose:d,onTransferred:l}){const[o,a]=N.useState(I),[i,h]=N.useState(null),m=s?.quantity??0,p=N.useMemo(()=>s?s.locationCode&&s.locationName?`${s.locationCode} Â· ${s.locationName}`:s.locationCode?s.locationCode:s.locationName?s.locationName:"Sin ubicaciÃ³n asignada":"â€”",[s]);N.useEffect(()=>{if(!t){a(I),h(null);return}a(j=>({...I,qty:m>0?String(Math.min(m,1)):""})),h(null)},[t,m]);const c=C({queryKey:["locations"],queryFn:()=>ne(),enabled:t,staleTime:300*1e3}),g=N.useMemo(()=>!c.data||!s?.locationId?c.data??[]:c.data.filter(j=>j.id!==s.locationId),[c.data,s?.locationId]),n=T({mutationFn:async()=>{if(!s)throw new Error("No hay lote seleccionado");const j=Number(o.qty);if(!Number.isFinite(j)||j<=0)throw new Error("La cantidad debe ser mayor a 0");if(j>m)throw new Error(`La cantidad no puede superar ${m}`);if(!o.targetLocationId)throw new Error("Selecciona una ubicaciÃ³n destino");const v={targetLocationId:o.targetLocationId,qty:j,note:o.note.trim()||void 0};await re(s.lotId,v)},onSuccess:()=>{a(I),l?.(),d()},onError:j=>{const v=De(j);h(v)}}),r=j=>{j.preventDefault(),!n.isPending&&(h(null),n.mutate())},f=!s||!o.targetLocationId||!o.qty||Number(o.qty)<=0||Number(o.qty)>m||g.length===0||n.isPending;return e.jsx(F,{open:t,onClose:d,title:"Transferir stock",className:"modal-card",children:e.jsxs("form",{onSubmit:r,style:{width:"100%",maxWidth:"480px"},children:[e.jsxs("section",{className:"transfer-summary",children:[e.jsx("p",{className:"muted small",children:"Producto"}),e.jsx("p",{style:{marginBottom:"0.75rem",fontWeight:600},children:x}),e.jsxs("div",{className:"summary-row",children:[e.jsxs("div",{children:[e.jsx("p",{className:"muted small",children:"UbicaciÃ³n actual"}),e.jsx("p",{children:p})]}),e.jsxs("div",{children:[e.jsx("p",{className:"muted small",children:"Stock disponible"}),e.jsx("p",{className:"mono",children:m})]})]})]}),g.length===0&&!c.isLoading&&e.jsx("p",{className:"panel-error",style:{marginBottom:"1rem"},children:"No hay ubicaciones destino disponibles para transferir."}),e.jsxs("div",{className:"form-grid",style:{display:"grid",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("label",{className:"form-field",children:[e.jsx("span",{className:"label",children:"UbicaciÃ³n destino"}),e.jsxs("select",{className:"input",value:o.targetLocationId,onChange:j=>a(v=>({...v,targetLocationId:j.target.value})),disabled:c.isLoading||n.isPending||g.length===0,"data-autofocus":!0,children:[e.jsx("option",{value:"",children:"Selecciona una ubicaciÃ³nâ€¦"}),g.map(j=>e.jsxs("option",{value:j.id,children:[j.code," Â· ",j.name]},j.id))]}),c.isLoading&&e.jsx("span",{className:"muted small",children:"Cargando ubicacionesâ€¦"})]}),e.jsxs("label",{className:"form-field",children:[e.jsx("span",{className:"label",children:"Cantidad a transferir"}),e.jsx("input",{className:"input",type:"number",min:"0",step:"0.01",value:o.qty,onChange:j=>a(v=>({...v,qty:j.target.value})),disabled:n.isPending}),e.jsxs("span",{className:"muted very-small",children:["MÃ¡ximo permitido: ",m]})]}),e.jsxs("label",{className:"form-field",children:[e.jsx("span",{className:"label",children:"Comentario (opcional)"}),e.jsx("textarea",{className:"input",rows:3,value:o.note,onChange:j=>a(v=>({...v,note:j.target.value})),placeholder:"Ej. mover a bodega principal",disabled:n.isPending})]})]}),i&&e.jsx("p",{className:"panel-error",style:{marginTop:"1rem"},children:i}),e.jsxs("footer",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"flex-end",gap:"0.75rem"},children:[e.jsx("button",{type:"button",className:"btn ghost",onClick:d,disabled:n.isPending,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn primary",disabled:f,children:n.isPending?"Transfiriendoâ€¦":"Transferir"})]})]})})}function De(t){if(Y.isAxiosError(t)){const s=t.response?.data;if(s){if(typeof s=="string")return s;if(typeof s=="object"){const x=s.message??s.detail??s.error;if(x&&typeof x=="string")return x}}return t.response?.statusText??"No se pudo completar la transferencia"}return t instanceof Error&&t.message?t.message:"No se pudo completar la transferencia"}function qe({open:t,product:s,pendingValue:x,submitting:d=!1,error:l,onClose:o,onSubmit:a}){const[i,h]=N.useState("0"),[m,p]=N.useState(null),c=N.useMemo(()=>{if(typeof x=="number")return x;const j=Number(s?.criticalStock??0);return Number.isFinite(j)&&j>=0?j:0},[x,s?.criticalStock]);N.useEffect(()=>{if(!t||!s){h("0"),p(null);return}h(String(c)),p(null)},[t,s?.id,c]);const g=j=>{j.preventDefault();const v=Number(i);if(!Number.isFinite(v)||v<0){p("Ingresa un stock vÃ¡lido (mayor o igual a 0)");return}p(null),a(v)},n=()=>{d||o()},r=s?`Stock crÃ­tico - ${s.name}`:"Stock crÃ­tico",f=!!m||!!l;return e.jsx(F,{open:t,title:r,onClose:n,children:e.jsxs("form",{className:"form-grid",onSubmit:g,children:[e.jsxs("label",{children:[e.jsx("span",{children:"Stock crÃ­tico"}),e.jsx("input",{className:`input${f?" input-error":""}`,type:"number",min:"0",step:"1",value:i,onChange:j=>h(j.target.value),disabled:d,"data-autofocus":!0,inputMode:"numeric"})]}),e.jsxs("div",{className:"buttons",children:[e.jsx("button",{className:"btn",type:"submit",disabled:d,children:d?"Guardando...":"Guardar"}),e.jsx("button",{className:"btn ghost",type:"button",onClick:n,disabled:d,children:"Cancelar"})]}),m&&e.jsx("p",{className:"error",children:m}),!m&&l&&e.jsx("p",{className:"error",children:l})]})})}function Be({open:t,product:s,onClose:x}){const[d,l]=N.useState("details"),[o,a]=N.useState(null),[i,h]=N.useState(!1),[m,p]=N.useState({price:0}),c=J(),g=C({queryKey:["product-prices",s?.id],queryFn:()=>{if(!s)throw new Error("Producto no seleccionado");return ie(s.id,{size:10})},enabled:!!s&&t}),n=C({queryKey:["product",s?.id,"stock"],queryFn:()=>{if(!s)throw new Error("Producto no seleccionado");return oe(s.id)},enabled:!!s&&t}),r=g.data?.content??[],f=T({mutationFn:async()=>{if(!s)throw new Error("Producto no seleccionado");if(!m.price||m.price<=0)throw new Error("Ingresa un precio vÃ¡lido");return le(s.id,m)},onSuccess:()=>{c.invalidateQueries({queryKey:["products"],exact:!1}),c.invalidateQueries({queryKey:["product-prices",s?.id]}),p({price:0}),l("prices")}}),j=u=>{u.preventDefault(),!f.isPending&&f.mutate()},v=u=>{if(typeof u=="number")return Number.isFinite(u)&&u>0?`$${u.toFixed(2)}`:"Sin precio";if(typeof u=="string"&&u.trim().length>0){const y=Number(u);return Number.isFinite(y)&&y>0?`$${y.toFixed(2)}`:"Sin precio"}return"Sin precio"},b=N.useMemo(()=>s?v(s.currentPrice):"",[s]),S=N.useMemo(()=>{if(!s?.criticalStock)return 0;const u=Number(s.criticalStock);return Number.isFinite(u)?u:0},[s]);return s?e.jsxs(e.Fragment,{children:[e.jsx(F,{open:t,onClose:x,title:s.name,className:"modal-wide",children:e.jsxs("div",{style:{width:"100%",maxWidth:"1000px"},children:[e.jsxs("div",{className:"tabs-container",children:[e.jsx("button",{className:`tab-button ${d==="details"?"active":""}`,onClick:()=>l("details"),type:"button",children:"ðŸ“‹ Detalles"}),e.jsx("button",{className:`tab-button ${d==="prices"?"active":""}`,onClick:()=>l("prices"),type:"button",children:"ðŸ’° Precios"}),e.jsx("button",{className:`tab-button ${d==="inventory"?"active":""}`,onClick:()=>l("inventory"),type:"button",children:"ðŸ“¦ Inventario"})]}),d==="details"&&e.jsx("div",{className:"tab-content",children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",padding:"1.5rem",background:"var(--bg-secondary)",borderRadius:"12px",border:"1px solid var(--border-color)"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"muted small",children:"SKU"}),e.jsx("p",{style:{fontWeight:600,fontSize:"1.05rem"},children:s.sku})]}),e.jsxs("div",{children:[e.jsx("p",{className:"muted small",children:"Precio actual"}),e.jsx("p",{style:{fontWeight:600,fontSize:"1.05rem",color:"var(--accent)"},children:b})]}),e.jsxs("div",{children:[e.jsx("p",{className:"muted small",children:"CategorÃ­a"}),e.jsx("p",{style:{fontWeight:600,fontSize:"1.05rem"},children:s.category||"â€”"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"muted small",children:"Estado"}),e.jsx("p",{style:{fontWeight:600,fontSize:"1.05rem"},children:s.active?e.jsx("span",{style:{color:"var(--success-color)"},children:"âœ“ Activo"}):e.jsx("span",{style:{color:"var(--error-color)"},children:"âœ— Inactivo"})})]})]})}),d==="prices"&&e.jsxs("div",{className:"tab-content",children:[e.jsxs("form",{onSubmit:j,style:{padding:"1.5rem",background:"var(--bg-secondary)",borderRadius:"12px",border:"1px solid var(--border-color)",marginBottom:"1.5rem"},children:[e.jsx("h4",{style:{marginBottom:"1rem",fontSize:"1rem",fontWeight:600},children:"Actualizar precio"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"1rem"},children:[e.jsxs("label",{children:[e.jsx("span",{className:"muted small",children:"Nuevo precio"}),e.jsx("input",{className:"input",type:"number",min:"0",step:"0.01",value:m.price||"",onChange:u=>p({price:Number(u.target.value)}),placeholder:"Ingresa el nuevo precio",disabled:f.isPending,required:!0})]}),e.jsx("button",{className:"btn primary",type:"submit",disabled:f.isPending,style:{alignSelf:"end"},children:f.isPending?"Guardando...":"Actualizar precio"})]}),f.isError&&e.jsx("p",{className:"error",style:{marginTop:"0.75rem"},children:f.error?.message??"No se pudo actualizar el precio"})]}),e.jsx("h4",{style:{marginBottom:"1rem",fontSize:"1rem",fontWeight:600},children:"HistÃ³rico de precios"}),g.isLoading&&e.jsx("p",{className:"muted",children:"Cargando precios..."}),g.isError&&e.jsx("p",{className:"error",children:g.error?.message??"No se pudieron cargar los precios"}),!g.isLoading&&r.length===0&&e.jsx("p",{className:"muted",children:"No hay histÃ³rico de precios"}),!g.isLoading&&r.length>0&&e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"table compact",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Desde"})]})}),e.jsx("tbody",{children:r.map((u,y)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"mono",style:{fontWeight:600},children:["$",Number(u.price).toLocaleString()]}),e.jsx("td",{className:"mono small",children:new Date(u.validFrom).toLocaleString("es-CL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]},y))})]})})]}),d==="inventory"&&e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h4",{style:{fontSize:"1.1rem",fontWeight:600,margin:0},children:"Inventario"}),e.jsx("button",{className:"btn ghost small",type:"button",onClick:()=>h(!0),children:"Definir stock crÃ­tico"})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("p",{className:"muted",children:["Stock total:"," ",n.isLoading?"Cargando...":n.data?n.data.total:"Sin datos"]}),e.jsxs("p",{className:"muted",children:["Stock crÃ­tico configurado: ",S]})]}),n.isError&&e.jsx("p",{className:"error",children:n.error?.message??"No se pudo obtener el stock"}),n.isLoading&&e.jsx("p",{className:"muted",children:"Cargando lotes..."}),n.data&&n.data.lots.length>0&&e.jsx("div",{className:"table-wrapper compact",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Lote"}),e.jsx("th",{children:"Batch"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Costo Unit."}),e.jsx("th",{children:"Factura Origen"}),e.jsx("th",{children:"UbicaciÃ³n"}),e.jsx("th",{children:"Mfg."}),e.jsx("th",{children:"Vence"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:n.data.lots.map(u=>e.jsxs("tr",{children:[e.jsx("td",{className:"mono small",children:u.lotId.substring(0,8)}),e.jsx("td",{className:"mono small",children:u.batchName||"â€”"}),e.jsx("td",{className:"mono",children:u.quantity}),e.jsx("td",{className:"mono small",children:u.costUnit?`$${u.costUnit.toLocaleString()}`:"â€”"}),e.jsx("td",{className:"mono small",children:u.purchaseDocNumber?e.jsxs("span",{style:{background:"var(--accent-soft)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:["ðŸ“„ ",u.purchaseDocNumber]}):e.jsx("span",{style:{color:"var(--muted)"},children:"Sin factura"})}),e.jsx("td",{children:u.locationCode?e.jsx("span",{title:u.locationName||"",children:u.locationCode}):"â€”"}),e.jsx("td",{className:"mono small",children:u.manufactureDate?new Date(u.manufactureDate).toLocaleDateString("es-CL"):"â€”"}),e.jsx("td",{className:"mono small",children:u.expiryDate?new Date(u.expiryDate).toLocaleDateString("es-CL"):"â€”"}),e.jsx("td",{children:e.jsx("button",{className:"btn small primary",onClick:()=>a({product:s,lot:u}),type:"button",children:"Transferir"})})]},u.lotId))})]})}),n.data&&n.data.lots.length===0&&e.jsx("p",{className:"muted",style:{textAlign:"center",padding:"2rem"},children:"No hay lotes disponibles"})]})]})}),e.jsx(Me,{open:!!o,lot:o?.lot??null,productName:o?.product.name??"",onClose:()=>a(null),onTransferred:()=>{o?.product.id&&c.invalidateQueries({queryKey:["product",o.product.id,"stock"]}),c.invalidateQueries({queryKey:["inventoryMovements"],exact:!1})}}),e.jsx(qe,{open:i,product:s,onClose:()=>h(!1),onSubmit:async u=>{console.log("Update critical stock to:",u),h(!1)}})]}):null}const M={sku:"",name:"",description:"",category:"",barcode:"",imageUrl:null,imageFile:null};function Re({open:t,product:s,onClose:x,onSaved:d}){const[l,o]=N.useState(M),[a,i]=N.useState(null),[h,m]=N.useState(null),p=N.useRef(null),c=N.useRef(null);N.useEffect(()=>()=>{c.current&&c.current.startsWith("blob:")&&URL.revokeObjectURL(c.current)},[]),N.useEffect(()=>{if(!t){o(M),m(null),f(null);return}s?(o({sku:s.sku??"",name:s.name??"",description:s.description??"",category:s.category??"",barcode:s.barcode??"",imageUrl:s.imageUrl??null,imageFile:null}),m(null),f(s.imageUrl??null)):(o(M),m(null),f(null))},[t,s]);const g=T({mutationFn:u=>s?de(s.id,u):ce(u),onSuccess:u=>{d?.(u),x()}});N.useEffect(()=>{t||g.reset()},[t,g]);const n=u=>{const y=u.target.files?.[0];if(!y)return;if(y.size>512*1024){m("La imagen debe pesar 500 KB o menos"),u.target.value="";return}m(null),o(k=>({...k,imageFile:y}));const P=URL.createObjectURL(y);j(P)},r=()=>{if(m(null),l.imageFile){const u=l.imageUrl??null;o(y=>({...y,imageFile:null})),j(u)}else o(u=>({...u,imageUrl:null})),j(null);p.current&&(p.current.value="")},f=u=>{j(u)},j=u=>{c.current&&c.current.startsWith("blob:")&&URL.revokeObjectURL(c.current),c.current=u,i(u)},v=u=>{u.preventDefault();const y=l.sku.trim(),P=l.name.trim();if(!y){window.alert("El SKU es obligatorio");return}if(!P){window.alert("El nombre es obligatorio");return}const k={sku:y,name:P,description:l.description.trim()?l.description.trim():void 0,category:l.category.trim()?l.category.trim():void 0,barcode:l.barcode.trim()?l.barcode.trim():void 0};l.imageFile?(k.imageFile=l.imageFile,k.imageUrl=null):l.imageUrl===null?k.imageUrl=null:typeof l.imageUrl=="string"&&l.imageUrl.trim().length>0&&(k.imageUrl=l.imageUrl.trim()),g.mutate(k)},b=s?"Editar producto":"Nuevo producto",S=!!a;return e.jsx(F,{open:t,title:b,onClose:()=>!g.isPending&&x(),children:e.jsxs("form",{className:"form-grid",onSubmit:v,children:[e.jsxs("label",{children:[e.jsx("span",{children:"SKU *"}),e.jsx("input",{className:"input",value:l.sku,onChange:u=>o(y=>({...y,sku:u.target.value})),placeholder:"SKU-001",disabled:g.isPending,"data-autofocus":!0})]}),e.jsxs("label",{children:[e.jsx("span",{children:"Nombre *"}),e.jsx("input",{className:"input",value:l.name,onChange:u=>o(y=>({...y,name:u.target.value})),placeholder:"Producto demo",disabled:g.isPending})]}),e.jsxs("label",{children:[e.jsx("span",{children:"Categoria"}),e.jsx("input",{className:"input",value:l.category,onChange:u=>o(y=>({...y,category:u.target.value})),placeholder:"Bebidas",disabled:g.isPending})]}),e.jsxs("label",{children:[e.jsx("span",{children:"Codigo de barras"}),e.jsx("input",{className:"input",value:l.barcode,onChange:u=>o(y=>({...y,barcode:u.target.value})),placeholder:"7890000000",disabled:g.isPending})]}),e.jsxs("label",{children:[e.jsx("span",{children:"Descripcion"}),e.jsx("textarea",{className:"input",value:l.description,onChange:u=>o(y=>({...y,description:u.target.value})),placeholder:"Notas internas",rows:3,disabled:g.isPending})]}),e.jsxs("label",{children:[e.jsx("span",{children:"Imagen"}),S?e.jsx("div",{className:"image-preview",children:e.jsx("img",{src:a??void 0,alt:"Vista previa del producto"})}):e.jsx("p",{className:"muted small",children:"No has seleccionado una imagen"}),e.jsx("input",{ref:p,className:"input",type:"file",accept:"image/png,image/jpeg,image/webp,image/*",onChange:n,disabled:g.isPending}),e.jsx("p",{className:"muted small",children:"Formatos aceptados: PNG, JPG o WebP. Tamao mximo 500 KB."}),(l.imageFile||l.imageUrl)&&e.jsx("div",{className:"inline-actions",children:e.jsx("button",{className:"btn ghost",type:"button",onClick:r,disabled:g.isPending,children:"Quitar imagen"})}),h&&e.jsx("p",{className:"error",children:h})]}),e.jsxs("div",{className:"buttons",children:[e.jsx("button",{className:"btn",type:"submit",disabled:g.isPending,children:g.isPending?"Guardando...":"Guardar"}),e.jsx("button",{className:"btn ghost",type:"button",onClick:x,disabled:g.isPending,children:"Cancelar"})]}),g.isError&&e.jsx("p",{className:"error",children:$e(g.error)})]})})}function $e(t){if(Y.isAxiosError(t)){const s=t.response?.data;if(typeof s=="string"&&s.trim().length>0)return s;if(s&&typeof s=="object"){if(typeof s.detail=="string"&&s.detail.trim().length>0)return s.detail;if(typeof s.message=="string"&&s.message.trim().length>0)return s.message;if(typeof s.error=="string"&&s.error.trim().length>0)return s.error}}return t instanceof Error&&t.message?t.message:"No se pudo guardar"}async function Oe(t){const s=new URLSearchParams;t.productId&&s.append("productId",t.productId),t.type&&s.append("type",t.type),t.from&&s.append("from",t.from),t.to&&s.append("to",t.to),s.append("page",String(t.page??0)),s.append("size",String(t.size));const x=await fetch(`/api/v1/inventory/movements?${s}`);if(!x.ok)throw new Error("Error al cargar movimientos");return x.json()}const H=[{value:"",label:"Todos los tipos"},{value:"MANUAL_IN",label:"Entrada manual"},{value:"MANUAL_OUT",label:"Salida manual"},{value:"SALE_OUT",label:"Venta"},{value:"SALE_CANCEL",label:"CancelaciÃ³n venta"},{value:"PURCHASE_IN",label:"Compra"}];function Ue(){const[t,s]=N.useState(0),[x,d]=N.useState(""),[l,o]=N.useState(""),[a,i]=N.useState(""),h=C({queryKey:["inventory-movements",t,x,l,a],queryFn:()=>Oe({type:x||void 0,from:l?new Date(l).toISOString():void 0,to:a?new Date(a+"T23:59:59").toISOString():void 0,page:t,size:20})}),m=c=>H.find(g=>g.value===c)?.label??c,p=c=>{switch(c){case"MANUAL_IN":case"PURCHASE_IN":return"status active";case"MANUAL_OUT":case"SALE_OUT":return"status cancelled";case"SALE_CANCEL":return"status warning";default:return"status"}};return e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:"Historial de Movimientos (AuditorÃ­a)"}),e.jsx("p",{className:"muted",style:{marginBottom:"1rem"},children:"Registro completo de todos los movimientos de inventario con trazabilidad"}),e.jsxs("div",{className:"filter-bar",style:{marginBottom:"1rem"},children:[e.jsx("select",{className:"input",value:x,onChange:c=>{d(c.target.value),s(0)},children:H.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))}),e.jsx("input",{type:"date",className:"input",value:l,onChange:c=>{o(c.target.value),s(0)},placeholder:"Desde"}),e.jsx("input",{type:"date",className:"input",value:a,onChange:c=>{i(c.target.value),s(0)},placeholder:"Hasta"}),(x||l||a)&&e.jsx("button",{className:"btn ghost",onClick:()=>{d(""),o(""),i(""),s(0)},children:"Limpiar filtros"})]}),e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Fecha"}),e.jsx("th",{children:"Tipo"}),e.jsx("th",{children:"Producto"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Stock Anterior"}),e.jsx("th",{children:"Stock Nuevo"}),e.jsx("th",{children:"Usuario"}),e.jsx("th",{children:"IP"}),e.jsx("th",{children:"Nota"})]})}),e.jsxs("tbody",{children:[h.isLoading&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"muted",children:"Cargando movimientos..."})}),h.isError&&e.jsx("tr",{children:e.jsxs("td",{colSpan:9,className:"error",children:["Error: ",h.error.message]})}),!h.isLoading&&!h.isError&&h.data?.content.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"mono small",children:new Date(c.createdAt).toLocaleString("es-CL")}),e.jsx("td",{children:e.jsx("span",{className:p(c.type),children:m(c.type)})}),e.jsx("td",{children:c.productName}),e.jsxs("td",{className:"mono",children:[c.type.includes("OUT")?"-":"+",Number(c.qty).toFixed(2)]}),e.jsx("td",{className:"mono",children:c.previousQty!=null?Number(c.previousQty).toFixed(2):"-"}),e.jsx("td",{className:"mono",children:c.newQty!=null?Number(c.newQty).toFixed(2):"-"}),e.jsx("td",{className:"small",children:c.createdBy??"Sistema"}),e.jsx("td",{className:"mono small",children:c.userIp??"-"}),e.jsx("td",{className:"small",children:c.note??"-"})]},c.id)),!h.isLoading&&!h.isError&&h.data?.content.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"muted",children:"No hay movimientos"})})]})]})}),h.data&&h.data.totalPages>1&&e.jsxs("div",{className:"pagination",children:[e.jsx("button",{className:"btn",disabled:t===0,onClick:()=>s(c=>Math.max(0,c-1)),children:"Anterior"}),e.jsxs("span",{className:"muted",children:["PÃ¡gina ",t+1," de ",h.data.totalPages]}),e.jsx("button",{className:"btn",disabled:t+1>=h.data.totalPages,onClick:()=>s(c=>c+1),children:"Siguiente"})]}),h.data&&e.jsx("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#f5f5f5",borderRadius:"4px"},children:e.jsxs("p",{className:"muted small",children:[e.jsx("strong",{children:"Total de registros:"})," ",h.data.totalElements," movimientos"]})})]})}function ze(){N.useMemo(()=>R(),[]);const t=C({queryKey:["products-rotation"],queryFn:()=>A({size:200,status:"all"})}),s=t.data?.content??[],x=N.useMemo(()=>{const d=s.map(n=>{const r=Number(n.stock??0),j=Number(n.currentPrice??0)*.7,v=r*j,b=Math.random()*20;return{id:n.id,name:n.name??"Sin nombre",stock:r,value:v,rotation:b,category:n.category??"General"}}),l=d.reduce((n,r)=>n+r.value,0),o=[...d].sort((n,r)=>r.value-n.value);let a=0;const i=o.map(n=>{a+=n.value;const r=l>0?a/l*100:0;return{...n,class:r<=80?"A":r<=95?"B":"C"}}),h=i.filter(n=>n.class==="A"),m=i.filter(n=>n.class==="B"),p=i.filter(n=>n.class==="C"),c=[...d].sort((n,r)=>r.rotation-n.rotation).slice(0,5),g=[...d].sort((n,r)=>n.rotation-r.rotation).slice(0,5);return{classA:h,classB:m,classC:p,topMovers:c,slowMovers:g,totalValue:l}},[s]);return t.isLoading?e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl shadow-lg p-5",children:[e.jsx("h3",{className:"text-neutral-100 mb-4",children:"AnÃ¡lisis de RotaciÃ³n"}),e.jsx("div",{className:"animate-pulse bg-neutral-800 rounded-lg h-80"})]}):e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl shadow-lg p-5",children:[e.jsx("h3",{className:"text-neutral-100 mb-4",children:"AnÃ¡lisis de RotaciÃ³n (ABC)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-950 border border-green-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-green-400 font-medium mb-2",children:"ðŸ“Š Clase A (80%)"}),e.jsx("p",{className:"text-green-100 text-2xl font-bold",children:x.classA.length}),e.jsx("p",{className:"text-green-300 text-sm",children:"Productos crÃ­ticos"})]}),e.jsxs("div",{className:"bg-yellow-950 border border-yellow-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-yellow-400 font-medium mb-2",children:"ðŸ“ˆ Clase B (15%)"}),e.jsx("p",{className:"text-yellow-100 text-2xl font-bold",children:x.classB.length}),e.jsx("p",{className:"text-yellow-300 text-sm",children:"Productos importantes"})]}),e.jsxs("div",{className:"bg-neutral-800 border border-neutral-700 rounded-lg p-4",children:[e.jsx("h4",{className:"text-neutral-300 font-medium mb-2",children:"ðŸ“‰ Clase C (5%)"}),e.jsx("p",{className:"text-neutral-100 text-2xl font-bold",children:x.classC.length}),e.jsx("p",{className:"text-neutral-400 text-sm",children:"Baja prioridad"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-neutral-300 font-medium mb-3",children:"ðŸ”¥ Top Movers"}),e.jsx("div",{className:"space-y-2",children:x.topMovers.map((d,l)=>e.jsx("div",{className:"bg-neutral-800 border border-neutral-700 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-neutral-100 font-medium",children:[l===0?"ðŸ¥‡":l===1?"ðŸ¥ˆ":l===2?"ðŸ¥‰":`${l+1}.`," ",d.name]}),e.jsxs("span",{className:"text-green-400 font-semibold",children:[d.rotation.toFixed(1)," u/mes"]})]})},d.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-neutral-300 font-medium mb-3",children:"ðŸŒ Slow Movers"}),e.jsx("div",{className:"space-y-2",children:x.slowMovers.map(d=>e.jsx("div",{className:"bg-neutral-800 border border-neutral-700 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-neutral-100 font-medium",children:d.name}),e.jsxs("span",{className:"text-red-400 font-semibold",children:[d.rotation.toFixed(1)," u/mes"]})]})},d.id))})]})]}),e.jsxs("div",{className:"mt-4 bg-blue-950 border border-blue-800 rounded-lg p-3 text-blue-400 text-sm",children:["ðŸ’¡ ",e.jsx("strong",{children:"Insight:"})," ClasificaciÃ³n ABC ayuda a priorizar gestiÃ³n de inventario segÃºn valor"]})]})}function Ke(){const t=N.useMemo(()=>R(),[]),s=i=>t.format(i??0),x=C({queryKey:["inventory-summary"],queryFn:D}),d=x.data,l=Number(d?.totalValue??0),o=N.useMemo(()=>[{month:"Hace 3m",value:l*.75},{month:"Hace 2m",value:l*.85},{month:"Hace 1m",value:l*.92},{month:"Actual",value:l}],[l]),a=Math.max(...o.map(i=>i.value));return x.isLoading?e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl shadow-lg p-5",children:[e.jsx("h3",{className:"text-neutral-100 mb-4",children:"EvoluciÃ³n de ValorizaciÃ³n"}),e.jsx("div",{className:"animate-pulse bg-neutral-800 rounded-lg h-64"})]}):e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl shadow-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-neutral-100",children:"EvoluciÃ³n de ValorizaciÃ³n"}),e.jsxs("span",{className:"px-3 py-1 bg-blue-950 text-blue-400 border border-blue-800 rounded-full text-sm",children:["ðŸ“ˆ Tendencia: +",((l/(l*.75)-1)*100).toFixed(1),"%"]})]}),e.jsx("div",{className:"space-y-4 mb-6",children:o.map((i,h)=>{const m=a>0?i.value/a*100:0,p=h===o.length-1;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-neutral-300 text-sm",children:i.month}),e.jsx("span",{className:"text-neutral-100 font-semibold",children:s(i.value)})]}),e.jsx("div",{className:"w-full bg-neutral-800 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-full ${p?"bg-gradient-to-r from-blue-600 to-blue-400":"bg-neutral-600"} transition-all`,style:{width:`${m}%`}})})]},i.month)})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-neutral-800 border border-neutral-700 rounded-lg p-3",children:[e.jsx("p",{className:"text-neutral-400 text-sm",children:"Valor Total"}),e.jsx("p",{className:"text-neutral-100 text-xl font-bold",children:s(l)})]}),e.jsxs("div",{className:"bg-neutral-800 border border-neutral-700 rounded-lg p-3",children:[e.jsx("p",{className:"text-neutral-400 text-sm",children:"Productos"}),e.jsx("p",{className:"text-neutral-100 text-xl font-bold",children:d?.activeProducts??0})]})]})]})}function Qe(){const t=C({queryKey:["products-replenishment"],queryFn:()=>A({size:100,status:"all"})}),s=X(),x=t.data?.content??[],d=N.useMemo(()=>x.map(l=>{const o=Number(l.stock??0),a=Math.random()*5+1,i=7,h=a*3,m=a*i+h,p=a*30,c=o<m,g=a>0?o/a:999,n=Math.max(0,p-o);return{id:l.id,name:l.name??"Sin nombre",stock:o,reorderPoint:m,daysOfCoverage:g,suggestedOrder:n,needsReplenishment:c,urgency:g<7?"critical":g<14?"high":"normal"}}).filter(l=>l.needsReplenishment).sort((l,o)=>l.daysOfCoverage-o.daysOfCoverage).slice(0,8),[x]);return t.isLoading?e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl shadow-lg p-5",children:[e.jsx("h3",{className:"text-neutral-100 mb-4",children:"Panel de Reabastecimiento"}),e.jsx("div",{className:"animate-pulse bg-neutral-800 rounded-lg h-80"})]}):e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl shadow-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-neutral-100",children:"Panel de Reabastecimiento"}),e.jsxs("span",{className:"px-3 py-1 bg-orange-950 text-orange-400 border border-orange-800 rounded-full text-sm",children:[d.length," productos requieren pedido"]})]}),d.length===0?e.jsx("div",{className:"bg-green-950 border border-green-800 rounded-lg p-4 text-center",children:e.jsx("p",{className:"text-green-400",children:"âœ… Todos los productos tienen stock suficiente"})}):e.jsx("div",{className:"space-y-3",children:d.map(l=>{const o={critical:{bg:"bg-red-950",border:"border-red-800",text:"text-red-400",icon:"ðŸ”´"},high:{bg:"bg-yellow-950",border:"border-yellow-800",text:"text-yellow-400",icon:"âš ï¸"},normal:{bg:"bg-blue-950",border:"border-blue-800",text:"text-blue-400",icon:"â„¹ï¸"}}[l.urgency]||{bg:"bg-neutral-950",border:"border-neutral-800",text:"text-neutral-400",icon:"â„¹ï¸"};return e.jsxs("div",{className:`${o.bg} border ${o.border} rounded-lg p-4`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-lg",children:o.icon}),e.jsx("h4",{className:"text-neutral-100 font-medium",children:l.name})]}),e.jsxs("p",{className:"text-neutral-400 text-sm",children:["Stock actual:"," ",e.jsxs("strong",{className:o.text,children:[l.stock," unidades"]})]}),e.jsxs("p",{className:"text-neutral-400 text-sm",children:["Cobertura: ",e.jsxs("strong",{children:[l.daysOfCoverage.toFixed(0)," dÃ­as"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-neutral-400 text-xs mb-1",children:"Cantidad sugerida"}),e.jsx("p",{className:`${o.text} text-2xl font-bold`,children:Math.ceil(l.suggestedOrder)})]})]}),e.jsx("button",{className:`w-full mt-2 px-4 py-2 ${o.bg} ${o.text} border ${o.border} rounded-lg hover:bg-opacity-80 transition`,onClick:()=>{const a=Math.max(Math.ceil(l.suggestedOrder),1),i=new URLSearchParams({productId:l.id,currentQty:String(l.stock),reorderPoint:String(l.reorderPoint),suggestedQty:String(a)});s(`/app/purchases/new?${i.toString()}`)},children:"Generar Orden de Compra"})]},l.id)})}),e.jsxs("div",{className:"mt-4 bg-blue-950 border border-blue-800 rounded-lg p-3 text-blue-400 text-sm",children:["ðŸ’¡ ",e.jsx("strong",{children:"Sugerencia:"})," Punto de reorden calculado segÃºn consumo + plazo de entrega + stock de seguridad"]})]})}function Ve(){const t=N.useMemo(()=>R(),[]),s=h=>t.format(h??0),x=C({queryKey:["inventory-summary"],queryFn:D}),d=C({queryKey:["products-efficiency"],queryFn:()=>A({size:200,status:"all"})}),l=x.data,o=d.data?.content??[],a=Number(l?.totalValue??0),i=N.useMemo(()=>{const h=o.length,c=o.reduce((u,y)=>u+Number(y.stock??0),0)/15,g=o.filter(u=>Number(u.stock??0)===0).length,n=h>0?g/h*100:0,r=12,f=150,j=(f-r)/f*100,S=a*.05/12;return{daysOfCoverage:c,stockOutRate:n,inventoryAccuracy:j,monthlyStorageCost:S,outOfStock:g,totalProducts:h}},[o,a]);return x.isLoading||d.isLoading?e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl shadow-lg p-5",children:[e.jsx("h3",{className:"text-neutral-100 mb-4",children:"MÃ©tricas de Eficiencia"}),e.jsx("div",{className:"animate-pulse bg-neutral-800 rounded-lg h-64"})]}):e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl shadow-lg p-5",children:[e.jsx("h3",{className:"text-neutral-100 mb-4",children:"MÃ©tricas de Eficiencia"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-950 border border-blue-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-blue-400 font-medium",children:"ðŸ“… DÃ­as de Cobertura"}),e.jsx("span",{className:"text-blue-300 text-2xl font-bold",children:i.daysOfCoverage.toFixed(0)})]}),e.jsx("p",{className:"text-blue-300 text-sm",children:"Stock actual / Consumo diario promedio"}),e.jsx("div",{className:"mt-2 w-full bg-blue-900 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-full rounded-full transition-all",style:{width:`${Math.min(i.daysOfCoverage/60*100,100)}%`}})})]}),e.jsxs("div",{className:"bg-red-950 border border-red-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-red-400 font-medium",children:"ðŸ“‰ Tasa de Quiebre"}),e.jsxs("span",{className:"text-red-300 text-2xl font-bold",children:[i.stockOutRate.toFixed(1),"%"]})]}),e.jsxs("p",{className:"text-red-300 text-sm",children:[i.outOfStock," de ",i.totalProducts," productos sin stock"]}),e.jsx("div",{className:"mt-2 w-full bg-red-900 rounded-full h-2",children:e.jsx("div",{className:"bg-red-500 h-full rounded-full transition-all",style:{width:`${i.stockOutRate}%`}})})]}),e.jsxs("div",{className:"bg-green-950 border border-green-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-green-400 font-medium",children:"âœ… PrecisiÃ³n Inventario"}),e.jsxs("span",{className:"text-green-300 text-2xl font-bold",children:[i.inventoryAccuracy.toFixed(1),"%"]})]}),e.jsx("p",{className:"text-green-300 text-sm",children:"Basado en movimientos vs ajustes"}),e.jsx("div",{className:"mt-2 w-full bg-green-900 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-full rounded-full transition-all",style:{width:`${i.inventoryAccuracy}%`}})})]}),e.jsxs("div",{className:"bg-purple-950 border border-purple-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-purple-400 font-medium",children:"ðŸ’° Costo Almacenamiento"}),e.jsx("span",{className:"text-purple-300 text-2xl font-bold",children:s(i.monthlyStorageCost)})]}),e.jsx("p",{className:"text-purple-300 text-sm",children:"Estimado mensual (~5% anual del valor)"})]})]}),e.jsxs("div",{className:"mt-4 bg-neutral-800 border border-neutral-700 rounded-lg p-4",children:[e.jsx("h4",{className:"text-neutral-100 font-medium mb-2",children:"Recomendaciones"}),e.jsxs("ul",{className:"space-y-1 text-neutral-300 text-sm",children:[i.stockOutRate>10&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-red-400",children:"âš ï¸"}),e.jsx("span",{children:"Tasa de quiebre alta. Revisar puntos de reorden."})]}),i.daysOfCoverage>90&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-yellow-400",children:"âš ï¸"}),e.jsx("span",{children:"Sobrestock detectado. Evaluar reducciÃ³n de inventario."})]}),i.inventoryAccuracy<95&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-orange-400",children:"âš ï¸"}),e.jsx("span",{children:"Baja precisiÃ³n. Realizar conteo cÃ­clico."})]}),i.stockOutRate<=5&&i.inventoryAccuracy>=95&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400",children:"âœ…"}),e.jsx("span",{children:"Inventario en niveles Ã³ptimos. Â¡Buen trabajo!"})]})]})]})]})}function _e(){const{data:t,isLoading:s,error:x}=C({queryKey:["inventoryKPIs"],queryFn:me,refetchInterval:6e4});if(s)return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((a,i)=>e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-neutral-800 rounded w-2/3 mb-3"}),e.jsx("div",{className:"h-8 bg-neutral-800 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-neutral-800 rounded w-3/4"})]},i))});if(x)return e.jsx("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-6 text-center",children:e.jsx("p",{className:"text-red-400",children:"Error al cargar KPIs de inventario"})});const d=a=>new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0}).format(a),l=a=>new Intl.NumberFormat("es-CL").format(a),o=[{title:"Cobertura de Stock",value:t?.stockCoverageDays!==null&&t?.stockCoverageDays!==void 0?`${t.stockCoverageDays.toFixed(1)} dÃ­as`:"N/A",subtitle:"DuraciÃ³n estimada del inventario",color:"text-blue-400",bgColor:"bg-blue-900/20",borderColor:"border-blue-800"},{title:"Ratio de RotaciÃ³n",value:t?.turnoverRatio?t.turnoverRatio.toFixed(2):"0.00",subtitle:"Veces por aÃ±o (anualizado)",color:"text-green-400",bgColor:"bg-green-900/20",borderColor:"border-green-800"},{title:"Stock Muerto",value:d(t?.deadStockValue||0),subtitle:`${t?.deadStockCount||0} productos sin movimiento >90 dÃ­as`,color:"text-orange-400",bgColor:"bg-orange-900/20",borderColor:"border-orange-800"},{title:"Tiempo de ReposiciÃ³n",value:`${t?.averageLeadTimeDays||0} dÃ­as`,subtitle:"Tiempo promedio de lead time",color:"text-purple-400",bgColor:"bg-purple-900/20",borderColor:"border-purple-800"},{title:"Stock CrÃ­tico",value:l(t?.criticalStockProducts||0),subtitle:"Productos bajo umbral",color:"text-red-400",bgColor:"bg-red-900/20",borderColor:"border-red-800"},{title:"Sobrestock",value:d(t?.overstockValue||0),subtitle:`${t?.overstockCount||0} productos excedidos`,color:"text-yellow-400",bgColor:"bg-yellow-900/20",borderColor:"border-yellow-800"}];return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map((a,i)=>e.jsxs("div",{className:`${a.bgColor} border ${a.borderColor} rounded-lg p-6 transition-all hover:scale-[1.02]`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-neutral-400",children:a.title}),e.jsx("div",{className:`w-10 h-10 rounded-lg ${a.bgColor} border ${a.borderColor} flex items-center justify-center`,children:e.jsx("span",{className:`text-xl ${a.color}`,children:"â—"})})]}),e.jsx("div",{className:`text-2xl font-bold ${a.color} mb-1`,children:a.value}),e.jsx("p",{className:"text-xs text-neutral-500",children:a.subtitle})]},i))})}function We(){const{data:t,isLoading:s,error:x}=C({queryKey:["stockMovementStats"],queryFn:ue,refetchInterval:6e4});if(s)return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-neutral-800 rounded w-1/3 mb-6"}),e.jsx("div",{className:"h-64 bg-neutral-800 rounded"})]});if(x)return e.jsx("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-6 text-center",children:e.jsx("p",{className:"text-red-400",children:"Error al cargar estadÃ­sticas de movimiento"})});const d=a=>new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0}).format(a),l=a=>new Intl.NumberFormat("es-CL").format(a),o=[{name:"Entradas",valor:t?.totalInflows||0,transacciones:t?.inflowTransactions||0},{name:"Salidas",valor:t?.totalOutflows||0,transacciones:t?.outflowTransactions||0}];return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-neutral-100 mb-2",children:"Resumen de Movimientos (Ãºltimos 30 dÃ­as)"}),e.jsx("p",{className:"text-sm text-neutral-400",children:"AnÃ¡lisis de entradas y salidas de inventario"})]}),e.jsx("div",{className:"mb-8",children:e.jsx($,{width:"100%",height:300,children:e.jsxs(O,{data:o,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(U,{strokeDasharray:"3 3",stroke:"#404040"}),e.jsx(z,{dataKey:"name",stroke:"#a3a3a3"}),e.jsx(K,{stroke:"#a3a3a3",tickFormatter:a=>d(a)}),e.jsx(Q,{contentStyle:{backgroundColor:"#262626",border:"1px solid #404040",borderRadius:"8px"},labelStyle:{color:"#f5f5f5"},formatter:a=>d(a)}),e.jsx(V,{}),e.jsx(L,{dataKey:"valor",fill:"#3b82f6",name:"Valor Total",radius:[8,8,0,0]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-900/20 border border-green-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-neutral-400 mb-1",children:"Total Entradas"}),e.jsx("div",{className:"text-2xl font-bold text-green-400",children:d(t?.totalInflows||0)}),e.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:[t?.inflowTransactions||0," transacciones"]})]}),e.jsxs("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-neutral-400 mb-1",children:"Total Salidas"}),e.jsx("div",{className:"text-2xl font-bold text-red-400",children:d(t?.totalOutflows||0)}),e.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:[t?.outflowTransactions||0," transacciones"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-neutral-300 mb-3",children:"Top 5 Entradas"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-neutral-800",children:e.jsxs("tr",{className:"text-left text-neutral-400",children:[e.jsx("th",{className:"pb-2 font-medium",children:"Producto"}),e.jsx("th",{className:"pb-2 font-medium text-right",children:"Cantidad"}),e.jsx("th",{className:"pb-2 font-medium text-right",children:"Valor"})]})}),e.jsx("tbody",{children:t?.topInflowProducts&&t.topInflowProducts.length>0?t.topInflowProducts.map((a,i)=>e.jsxs("tr",{className:"border-b border-neutral-800/50",children:[e.jsx("td",{className:"py-2 text-neutral-300",children:a.productName}),e.jsx("td",{className:"py-2 text-right text-neutral-400",children:l(a.quantity)}),e.jsx("td",{className:"py-2 text-right text-green-400",children:d(a.value)})]},i)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"py-4 text-center text-neutral-500",children:"Sin movimientos de entrada"})})})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-neutral-300 mb-3",children:"Top 5 Salidas"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-neutral-800",children:e.jsxs("tr",{className:"text-left text-neutral-400",children:[e.jsx("th",{className:"pb-2 font-medium",children:"Producto"}),e.jsx("th",{className:"pb-2 font-medium text-right",children:"Cantidad"}),e.jsx("th",{className:"pb-2 font-medium text-right",children:"Valor"})]})}),e.jsx("tbody",{children:t?.topOutflowProducts&&t.topOutflowProducts.length>0?t.topOutflowProducts.map((a,i)=>e.jsxs("tr",{className:"border-b border-neutral-800/50",children:[e.jsx("td",{className:"py-2 text-neutral-300",children:a.productName}),e.jsx("td",{className:"py-2 text-right text-neutral-400",children:l(a.quantity)}),e.jsx("td",{className:"py-2 text-right text-red-400",children:d(a.value)})]},i)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"py-4 text-center text-neutral-500",children:"Sin movimientos de salida"})})})]})})]})]})]})}function He(){const{data:t,isLoading:s,error:x}=C({queryKey:["abcAnalysis"],queryFn:()=>q(),refetchInterval:3e5});if(s)return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-neutral-800 rounded w-1/3 mb-6"}),e.jsx("div",{className:"h-80 bg-neutral-800 rounded"})]});if(x)return e.jsx("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-6 text-center",children:e.jsx("p",{className:"text-red-400",children:"Error al cargar anÃ¡lisis ABC"})});if(!t||t.length===0)return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 text-center",children:[e.jsx("p",{className:"text-neutral-400",children:"No hay datos suficientes para anÃ¡lisis ABC"}),e.jsx("p",{className:"text-xs text-neutral-500 mt-2",children:"El anÃ¡lisis requiere productos con inventario valorizado"})]});const d=n=>new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),l=t.filter(n=>n.classification==="A"),o=t.filter(n=>n.classification==="B"),a=t.filter(n=>n.classification==="C"),i=l.reduce((n,r)=>n+r.totalValue,0),h=o.reduce((n,r)=>n+r.totalValue,0),m=a.reduce((n,r)=>n+r.totalValue,0),p=i+h+m,c=[{name:"Clase A",productos:l.length,valor:i,porcentaje:(i/p*100).toFixed(1)},{name:"Clase B",productos:o.length,valor:h,porcentaje:(h/p*100).toFixed(1)},{name:"Clase C",productos:a.length,valor:m,porcentaje:(m/p*100).toFixed(1)}],g={A:"#22c55e",B:"#eab308",C:"#f97316"};return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-neutral-100 mb-2",children:"AnÃ¡lisis ABC de Inventario"}),e.jsx("p",{className:"text-sm text-neutral-400",children:"ClasificaciÃ³n por valor de inventario (Principio de Pareto 80-15-5)"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-900/20 border border-green-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-300",children:"Clase A"}),e.jsxs("span",{className:"px-2 py-1 bg-green-900/40 border border-green-800 rounded text-xs font-semibold text-green-400",children:[l.length," productos"]})]}),e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:d(i)}),e.jsxs("div",{className:"text-xs text-neutral-400",children:[(i/p*100).toFixed(1),"% del valor total"]}),e.jsx("div",{className:"text-xs text-neutral-500 mt-2",children:"Alta rotaciÃ³n - Control diario"})]}),e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-300",children:"Clase B"}),e.jsxs("span",{className:"px-2 py-1 bg-yellow-900/40 border border-yellow-800 rounded text-xs font-semibold text-yellow-400",children:[o.length," productos"]})]}),e.jsx("div",{className:"text-2xl font-bold text-yellow-400 mb-1",children:d(h)}),e.jsxs("div",{className:"text-xs text-neutral-400",children:[(h/p*100).toFixed(1),"% del valor total"]}),e.jsx("div",{className:"text-xs text-neutral-500 mt-2",children:"RotaciÃ³n media - Control semanal"})]}),e.jsxs("div",{className:"bg-orange-900/20 border border-orange-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-300",children:"Clase C"}),e.jsxs("span",{className:"px-2 py-1 bg-orange-900/40 border border-orange-800 rounded text-xs font-semibold text-orange-400",children:[a.length," productos"]})]}),e.jsx("div",{className:"text-2xl font-bold text-orange-400 mb-1",children:d(m)}),e.jsxs("div",{className:"text-xs text-neutral-400",children:[(m/p*100).toFixed(1),"% del valor total"]}),e.jsx("div",{className:"text-xs text-neutral-500 mt-2",children:"Baja rotaciÃ³n - Control mensual"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-neutral-300 mb-3",children:"DistribuciÃ³n de Valor por ClasificaciÃ³n"}),e.jsx($,{width:"100%",height:300,children:e.jsxs(O,{data:c,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(U,{strokeDasharray:"3 3",stroke:"#404040"}),e.jsx(z,{dataKey:"name",stroke:"#a3a3a3"}),e.jsx(K,{stroke:"#a3a3a3",tickFormatter:n=>d(n)}),e.jsx(Q,{contentStyle:{backgroundColor:"#262626",border:"1px solid #404040",borderRadius:"8px"},labelStyle:{color:"#f5f5f5"},formatter:n=>d(n)}),e.jsx(V,{}),e.jsx(L,{dataKey:"valor",name:"Valor Total",radius:[8,8,0,0],children:c.map((n,r)=>e.jsx(Z,{fill:r===0?g.A:r===1?g.B:g.C},`cell-${r}`))})]})})]}),e.jsx("div",{className:"bg-neutral-800/50 border border-neutral-700 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-neutral-400 mb-1",children:"Total Productos"}),e.jsx("div",{className:"text-lg font-semibold text-neutral-100",children:t.length})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-neutral-400 mb-1",children:"Valor Total Inventario"}),e.jsx("div",{className:"text-lg font-semibold text-neutral-100",children:d(p)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-neutral-400 mb-1",children:"ConcentraciÃ³n Clase A"}),e.jsxs("div",{className:"text-lg font-semibold text-green-400",children:[(l.length/t.length*100).toFixed(1),"% productos"]})]})]})})]})}function Ge(){const[t,s]=N.useState("all"),[x,d]=N.useState(""),[l,o]=N.useState(1),a=10,{data:i,isLoading:h,error:m}=C({queryKey:["abcAnalysis"],queryFn:()=>q(),refetchInterval:3e5});if(h)return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-neutral-800 rounded w-1/3 mb-4"}),e.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((b,S)=>e.jsx("div",{className:"h-12 bg-neutral-800 rounded"},S))})]});if(m||!i)return e.jsx("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-6 text-center",children:e.jsx("p",{className:"text-red-400",children:"Error al cargar productos"})});const p=b=>new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),c=b=>b?new Date(b).toLocaleDateString("es-CL"):"N/A",g=i.filter(b=>{const S=t==="all"||b.classification===t,u=b.productName.toLowerCase().includes(x.toLowerCase())||b.category.toLowerCase().includes(x.toLowerCase());return S&&u}),n=Math.ceil(g.length/a),r=(l-1)*a,f=r+a,j=g.slice(r,f),v=b=>{switch(b){case"A":return"bg-green-900/40 border-green-800 text-green-400";case"B":return"bg-yellow-900/40 border-yellow-800 text-yellow-400";case"C":return"bg-orange-900/40 border-orange-800 text-orange-400";default:return"bg-neutral-800 border-neutral-700 text-neutral-400"}};return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-100 mb-4",children:"Productos por ClasificaciÃ³n ABC"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Buscar producto o categorÃ­a...",value:x,onChange:b=>{d(b.target.value),o(1)},className:"w-full px-3 py-2 bg-neutral-800 border border-neutral-700 rounded-lg text-neutral-100 placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{s("all"),o(1)},className:`px-3 py-2 rounded-lg text-xs font-medium border transition-colors ${t==="all"?"bg-blue-900/40 border-blue-800 text-blue-400":"bg-neutral-800 border-neutral-700 text-neutral-400 hover:bg-neutral-700"}`,children:["Todos (",i.length,")"]}),e.jsx("button",{onClick:()=>{s("A"),o(1)},className:`px-3 py-2 rounded-lg text-xs font-medium border transition-colors ${t==="A"?"bg-green-900/40 border-green-800 text-green-400":"bg-neutral-800 border-neutral-700 text-neutral-400 hover:bg-neutral-700"}`,children:"Clase A"}),e.jsx("button",{onClick:()=>{s("B"),o(1)},className:`px-3 py-2 rounded-lg text-xs font-medium border transition-colors ${t==="B"?"bg-yellow-900/40 border-yellow-800 text-yellow-400":"bg-neutral-800 border-neutral-700 text-neutral-400 hover:bg-neutral-700"}`,children:"Clase B"}),e.jsx("button",{onClick:()=>{s("C"),o(1)},className:`px-3 py-2 rounded-lg text-xs font-medium border transition-colors ${t==="C"?"bg-orange-900/40 border-orange-800 text-orange-400":"bg-neutral-800 border-neutral-700 text-neutral-400 hover:bg-neutral-700"}`,children:"Clase C"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-neutral-800",children:e.jsxs("tr",{className:"text-left text-neutral-400",children:[e.jsx("th",{className:"pb-3 font-medium",children:"Clase"}),e.jsx("th",{className:"pb-3 font-medium",children:"Producto"}),e.jsx("th",{className:"pb-3 font-medium",children:"CategorÃ­a"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Valor Total"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"% del Total"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Cantidad"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Frecuencia"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Ãšltima Mov."})]})}),e.jsx("tbody",{children:j.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-8 text-center text-neutral-500",children:"No se encontraron productos"})}):j.map(b=>e.jsxs("tr",{className:"border-b border-neutral-800/50 hover:bg-neutral-800/30",children:[e.jsx("td",{className:"py-3",children:e.jsx("span",{className:`inline-flex px-2.5 py-1 rounded-md text-xs font-semibold border ${v(b.classification)}`,children:b.classification})}),e.jsx("td",{className:"py-3 text-neutral-100 font-medium",children:b.productName}),e.jsx("td",{className:"py-3 text-neutral-400",children:b.category}),e.jsx("td",{className:"py-3 text-right text-neutral-100 font-medium",children:p(b.totalValue)}),e.jsxs("td",{className:"py-3 text-right text-neutral-400",children:[b.percentageOfTotalValue.toFixed(2),"%"]}),e.jsx("td",{className:"py-3 text-right text-neutral-400",children:b.totalQuantity.toLocaleString("es-CL")}),e.jsx("td",{className:"py-3 text-right text-neutral-400",children:b.salesFrequency}),e.jsx("td",{className:"py-3 text-right text-neutral-400 text-xs",children:c(b.lastMovementDate)})]},b.productId))})]})}),n>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-neutral-500",children:["Mostrando ",r+1,"-",Math.min(f,g.length)," de"," ",g.length," productos"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>o(b=>Math.max(1,b-1)),disabled:l===1,className:"px-3 py-1 bg-neutral-800 border border-neutral-700 rounded text-xs text-neutral-400 hover:bg-neutral-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),e.jsxs("span",{className:"px-3 py-1 text-xs text-neutral-400",children:["PÃ¡gina ",l," de ",n]}),e.jsx("button",{onClick:()=>o(b=>Math.min(n,b+1)),disabled:l===n,className:"px-3 py-1 bg-neutral-800 border border-neutral-700 rounded text-xs text-neutral-400 hover:bg-neutral-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Siguiente"})]})]})]})}function Ye(){const{data:t,isLoading:s}=C({queryKey:["abcAnalysis"],queryFn:()=>q(),refetchInterval:3e5});if(s)return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-neutral-800 rounded w-2/3 mb-4"}),e.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((a,i)=>e.jsx("div",{className:"h-24 bg-neutral-800 rounded"},i))})]});const x=t?.filter(a=>a.classification==="A")||[],d=t?.filter(a=>a.classification==="B")||[],l=t?.filter(a=>a.classification==="C")||[],o=[{classification:"A",title:"Productos Clase A - Alta Prioridad",color:"green",bgColor:"bg-green-900/20",borderColor:"border-green-800",textColor:"text-green-400",count:x.length,strategies:[{icon:"ðŸ“Š",title:"Monitoreo Continuo",description:"Control diario de niveles de inventario y rotaciÃ³n"},{icon:"ðŸŽ¯",title:"Stock Ã“ptimo",description:"Mantener niveles Ã³ptimos para evitar quiebres"},{icon:"ðŸ”„",title:"ReposiciÃ³n Frecuente",description:"RevisiÃ³n y pedidos cada 1-3 dÃ­as segÃºn demanda"},{icon:"ðŸ“ˆ",title:"PrevisiÃ³n Exacta",description:"Usar modelos de forecasting para proyectar demanda"}]},{classification:"B",title:"Productos Clase B - Prioridad Media",color:"yellow",bgColor:"bg-yellow-900/20",borderColor:"border-yellow-800",textColor:"text-yellow-400",count:d.length,strategies:[{icon:"ðŸ“…",title:"Control Semanal",description:"RevisiÃ³n de inventario cada 5-7 dÃ­as"},{icon:"âš–ï¸",title:"Stock Balanceado",description:"Mantener inventario moderado sin excesos"},{icon:"ðŸ””",title:"Alertas AutomÃ¡ticas",description:"Configurar notificaciones de stock bajo"},{icon:"ðŸ“Š",title:"AnÃ¡lisis Trimestral",description:"Evaluar tendencias y ajustar polÃ­ticas"}]},{classification:"C",title:"Productos Clase C - Baja Prioridad",color:"orange",bgColor:"bg-orange-900/20",borderColor:"border-orange-800",textColor:"text-orange-400",count:l.length,strategies:[{icon:"ðŸ“†",title:"RevisiÃ³n Mensual",description:"Control bÃ¡sico mensual o bimestral"},{icon:"ðŸ“‰",title:"Minimizar Inventario",description:"Reducir stock al mÃ­nimo necesario"},{icon:"ðŸ”",title:"Evaluar DescontinuaciÃ³n",description:"Considerar eliminar productos de baja rotaciÃ³n"},{icon:"ðŸ’¡",title:"Pedidos por Demanda",description:"Comprar solo cuando hay orden confirmada"}]}];return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-100 mb-2",children:"Estrategias de GestiÃ³n por ClasificaciÃ³n"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Recomendaciones operativas basadas en el anÃ¡lisis ABC"})]}),e.jsx("div",{className:"space-y-4",children:o.map(a=>e.jsxs("div",{className:`${a.bgColor} border ${a.borderColor} rounded-lg p-4`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:`text-sm font-semibold ${a.textColor}`,children:a.title}),e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-semibold ${a.bgColor} border ${a.borderColor} ${a.textColor}`,children:[a.count," productos"]})]}),e.jsx("div",{className:"space-y-2",children:a.strategies.map((i,h)=>e.jsxs("div",{className:"flex items-start gap-3 bg-neutral-900/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xl flex-shrink-0",children:i.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs font-medium text-neutral-200 mb-1",children:i.title}),e.jsx("div",{className:"text-xs text-neutral-400",children:i.description})]})]},h))})]},a.classification))}),e.jsx("div",{className:"mt-6 bg-blue-900/20 border border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-2xl",children:"ðŸ’¡"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-400 mb-2",children:"Mejores PrÃ¡cticas"}),e.jsxs("ul",{className:"text-xs text-neutral-300 space-y-1",children:[e.jsx("li",{children:"â€¢ Concentrar esfuerzos en productos Clase A (80% del valor)"}),e.jsx("li",{children:"â€¢ Automatizar controles para productos Clase B"}),e.jsx("li",{children:"â€¢ Simplificar gestiÃ³n de productos Clase C"}),e.jsx("li",{children:"â€¢ Revisar clasificaciÃ³n ABC cada 3-6 meses"}),e.jsx("li",{children:"â€¢ Ajustar estrategias segÃºn estacionalidad"})]})]})]})})]})}function Je(){const{data:t,isLoading:s,error:x}=C({queryKey:["forecastAnalysis"],queryFn:()=>B(),refetchInterval:3e5});if(s)return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-8 bg-neutral-800 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-64 bg-neutral-800 rounded"})]});if(x)return e.jsx("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6",children:e.jsxs("p",{className:"text-red-400",children:["Error al cargar pronÃ³sticos: ",String(x)]})});if(!t||t.length===0)return e.jsx("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6",children:e.jsx("p",{className:"text-neutral-400",children:"No hay datos suficientes para generar pronÃ³sticos"})});const d=t.length,l=t.filter(n=>n.stockStatus==="understocked").length,o=t.filter(n=>n.stockStatus==="overstocked").length,a=t.filter(n=>n.stockStatus==="optimal").length,i=t.reduce((n,r)=>n+r.predictedDemand,0),h=t.reduce((n,r)=>n+r.currentStock,0),m=t.reduce((n,r)=>n+r.recommendedOrderQty,0),p=t.reduce((n,r)=>n+r.confidence,0)/d,c=t.slice(0,10).map(n=>({name:n.productName.length>20?n.productName.substring(0,20)+"...":n.productName,demandaPredicha:n.predictedDemand,stockActual:n.currentStock,status:n.stockStatus})),g=n=>{switch(n){case"understocked":return"#ef4444";case"overstocked":return"#f97316";case"optimal":return"#22c55e";default:return"#6b7280"}};return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"ðŸ“ˆ PronÃ³stico de Demanda (PrÃ³ximos 30 dÃ­as)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-neutral-800/50 border border-neutral-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-neutral-400",children:"Productos Analizados"}),e.jsx("div",{className:"text-2xl font-bold text-white mt-1",children:d})]}),e.jsxs("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-red-400",children:"Stock Bajo"}),e.jsx("div",{className:"text-2xl font-bold text-red-400 mt-1",children:l}),e.jsx("div",{className:"text-xs text-red-500 mt-1",children:"Requieren reposiciÃ³n"})]}),e.jsxs("div",{className:"bg-green-900/20 border border-green-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-green-400",children:"Stock Ã“ptimo"}),e.jsx("div",{className:"text-2xl font-bold text-green-400 mt-1",children:a}),e.jsx("div",{className:"text-xs text-green-500 mt-1",children:"Niveles adecuados"})]}),e.jsxs("div",{className:"bg-orange-900/20 border border-orange-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-orange-400",children:"Sobre-stock"}),e.jsx("div",{className:"text-2xl font-bold text-orange-400 mt-1",children:o}),e.jsx("div",{className:"text-xs text-orange-500 mt-1",children:"Exceso de inventario"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-neutral-800/50 border border-neutral-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-neutral-400",children:"Demanda Predicha Total"}),e.jsxs("div",{className:"text-xl font-bold text-white mt-1",children:[i.toFixed(0)," unidades"]})]}),e.jsxs("div",{className:"bg-neutral-800/50 border border-neutral-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-neutral-400",children:"Stock Actual Total"}),e.jsxs("div",{className:"text-xl font-bold text-white mt-1",children:[h.toFixed(0)," unidades"]})]}),e.jsxs("div",{className:"bg-neutral-800/50 border border-neutral-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-neutral-400",children:"Orden Recomendada Total"}),e.jsxs("div",{className:"text-xl font-bold text-blue-400 mt-1",children:[m.toFixed(0)," unidades"]})]})]}),e.jsxs("div",{className:"bg-neutral-800/30 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Top 10 Productos: Demanda Predicha vs Stock Actual"}),e.jsx($,{width:"100%",height:400,children:e.jsxs(O,{data:c,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(U,{strokeDasharray:"3 3",stroke:"#404040"}),e.jsx(z,{dataKey:"name",angle:-45,textAnchor:"end",height:100,stroke:"#a3a3a3",style:{fontSize:"12px"}}),e.jsx(K,{stroke:"#a3a3a3"}),e.jsx(Q,{contentStyle:{backgroundColor:"#262626",border:"1px solid #404040",borderRadius:"8px"},labelStyle:{color:"#fff"}}),e.jsx(V,{wrapperStyle:{paddingTop:"20px"},iconType:"circle"}),e.jsx(L,{dataKey:"demandaPredicha",name:"Demanda Predicha",fill:"#3b82f6"}),e.jsx(L,{dataKey:"stockActual",name:"Stock Actual",children:c.map((n,r)=>e.jsx(Z,{fill:g(n.status)},`cell-${r}`))})]})})]}),e.jsx("div",{className:"bg-blue-900/20 border border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-400",children:"Confianza Promedio del Modelo"}),e.jsx("div",{className:"text-xs text-neutral-400 mt-1",children:"Basado en historial de 90 dÃ­as"})]}),e.jsxs("div",{className:"text-3xl font-bold text-blue-400",children:[p.toFixed(0),"%"]})]})})]})}function Xe(){const[t,s]=N.useState("all"),[x,d]=N.useState("all"),[l,o]=N.useState(""),[a,i]=N.useState(1),h=10,{data:m,isLoading:p,error:c}=C({queryKey:["forecastAnalysis"],queryFn:()=>B(),refetchInterval:300*1e3});if(p)return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-8 bg-neutral-800 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-96 bg-neutral-800 rounded"})]});if(c)return e.jsx("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6",children:e.jsx("p",{className:"text-red-400",children:"Error al cargar pronÃ³sticos"})});if(!m||m.length===0)return e.jsx("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6",children:e.jsx("p",{className:"text-neutral-400",children:"No hay pronÃ³sticos disponibles"})});const g=m.filter(b=>{const S=t==="all"||b.stockStatus===t,u=x==="all"||b.trend===x,y=b.productName.toLowerCase().includes(l.toLowerCase())||b.category.toLowerCase().includes(l.toLowerCase());return S&&u&&y}),n=Math.ceil(g.length/h),r=(a-1)*h,f=g.slice(r,r+h),j=b=>{switch(b){case"understocked":return e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-900/40 border border-red-800 text-red-400",children:"Stock Bajo"});case"overstocked":return e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-orange-900/40 border border-orange-800 text-orange-400",children:"Sobre-stock"});case"optimal":return e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-900/40 border border-green-800 text-green-400",children:"Ã“ptimo"});default:return e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-neutral-800 border border-neutral-700 text-neutral-400",children:b})}},v=b=>{switch(b){case"increasing":return e.jsx("span",{className:"text-green-400",children:"â†—ï¸ Creciente"});case"decreasing":return e.jsx("span",{className:"text-red-400",children:"â†˜ï¸ Decreciente"});case"stable":return e.jsx("span",{className:"text-blue-400",children:"â†’ Estable"});default:return e.jsx("span",{className:"text-neutral-400",children:b})}};return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 space-y-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"ðŸŽ¯ Tabla de PronÃ³sticos"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>s("all"),className:`px-3 py-1.5 text-sm rounded-lg border transition ${t==="all"?"bg-blue-600 border-blue-500 text-white":"bg-neutral-800 border-neutral-700 text-neutral-300 hover:bg-neutral-700"}`,children:"Todos"}),e.jsx("button",{onClick:()=>s("understocked"),className:`px-3 py-1.5 text-sm rounded-lg border transition ${t==="understocked"?"bg-red-600 border-red-500 text-white":"bg-neutral-800 border-neutral-700 text-neutral-300 hover:bg-neutral-700"}`,children:"Stock Bajo"}),e.jsx("button",{onClick:()=>s("optimal"),className:`px-3 py-1.5 text-sm rounded-lg border transition ${t==="optimal"?"bg-green-600 border-green-500 text-white":"bg-neutral-800 border-neutral-700 text-neutral-300 hover:bg-neutral-700"}`,children:"Ã“ptimo"}),e.jsx("button",{onClick:()=>s("overstocked"),className:`px-3 py-1.5 text-sm rounded-lg border transition ${t==="overstocked"?"bg-orange-600 border-orange-500 text-white":"bg-neutral-800 border-neutral-700 text-neutral-300 hover:bg-neutral-700"}`,children:"Sobre-stock"})]}),e.jsx("input",{type:"text",placeholder:"Buscar producto o categorÃ­a...",value:l,onChange:b=>{o(b.target.value),i(1)},className:"flex-1 px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:border-blue-500"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-neutral-800",children:[e.jsx("th",{className:"text-left p-3 text-sm font-semibold text-neutral-400",children:"Estado"}),e.jsx("th",{className:"text-left p-3 text-sm font-semibold text-neutral-400",children:"Producto"}),e.jsx("th",{className:"text-left p-3 text-sm font-semibold text-neutral-400",children:"CategorÃ­a"}),e.jsx("th",{className:"text-right p-3 text-sm font-semibold text-neutral-400",children:"Stock Actual"}),e.jsx("th",{className:"text-right p-3 text-sm font-semibold text-neutral-400",children:"Demanda (30d)"}),e.jsx("th",{className:"text-right p-3 text-sm font-semibold text-neutral-400",children:"DÃ­as Stock"}),e.jsx("th",{className:"text-center p-3 text-sm font-semibold text-neutral-400",children:"Tendencia"}),e.jsx("th",{className:"text-right p-3 text-sm font-semibold text-neutral-400",children:"Orden Recomendada"}),e.jsx("th",{className:"text-right p-3 text-sm font-semibold text-neutral-400",children:"Confianza"})]})}),e.jsx("tbody",{children:f.map((b,S)=>e.jsxs("tr",{className:"border-b border-neutral-800 hover:bg-neutral-800/30 transition",children:[e.jsx("td",{className:"p-3",children:j(b.stockStatus)}),e.jsx("td",{className:"p-3 text-white font-medium",children:b.productName}),e.jsx("td",{className:"p-3 text-neutral-300",children:b.category}),e.jsx("td",{className:"p-3 text-right text-white",children:b.currentStock.toFixed(0)}),e.jsx("td",{className:"p-3 text-right text-blue-400 font-semibold",children:b.predictedDemand.toFixed(0)}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("span",{className:b.daysOfStock<15?"text-red-400 font-semibold":b.daysOfStock>60?"text-orange-400":"text-green-400",children:[b.daysOfStock," dÃ­as"]})}),e.jsx("td",{className:"p-3 text-center text-sm",children:v(b.trend)}),e.jsx("td",{className:"p-3 text-right",children:b.recommendedOrderQty>0?e.jsx("span",{className:"text-yellow-400 font-semibold",children:b.recommendedOrderQty.toFixed(0)}):e.jsx("span",{className:"text-neutral-500",children:"-"})}),e.jsxs("td",{className:"p-3 text-right text-neutral-400",children:[b.confidence.toFixed(0),"%"]})]},S))})]})}),n>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"text-sm text-neutral-400",children:["Mostrando ",r+1,"-",Math.min(r+h,g.length)," de"," ",g.length]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>i(b=>Math.max(1,b-1)),disabled:a===1,className:"px-3 py-1.5 text-sm bg-neutral-800 border border-neutral-700 rounded-lg text-neutral-300 hover:bg-neutral-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),e.jsxs("span",{className:"px-3 py-1.5 text-sm text-neutral-300",children:["PÃ¡gina ",a," de ",n]}),e.jsx("button",{onClick:()=>i(b=>Math.min(n,b+1)),disabled:a===n,className:"px-3 py-1.5 text-sm bg-neutral-800 border border-neutral-700 rounded-lg text-neutral-300 hover:bg-neutral-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Siguiente"})]})]}),g.length===0&&e.jsx("div",{className:"text-center py-8 text-neutral-400",children:"No se encontraron pronÃ³sticos con los filtros aplicados"})]})}function Ze(){const{data:t,isLoading:s}=C({queryKey:["forecastAnalysis"],queryFn:()=>B(),refetchInterval:3e5});if(s)return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-8 bg-neutral-800 rounded w-1/3 mb-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-20 bg-neutral-800 rounded"}),e.jsx("div",{className:"h-20 bg-neutral-800 rounded"}),e.jsx("div",{className:"h-20 bg-neutral-800 rounded"})]})]});if(!t||t.length===0)return e.jsx("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6",children:e.jsx("p",{className:"text-neutral-400",children:"No hay recomendaciones disponibles"})});const x=t.filter(a=>a.stockStatus==="understocked").sort((a,i)=>a.daysOfStock-i.daysOfStock).slice(0,5),d=t.filter(a=>a.trend==="increasing").sort((a,i)=>i.predictedDemand-a.predictedDemand).slice(0,3),l=t.filter(a=>a.stockStatus==="overstocked").sort((a,i)=>i.daysOfStock-a.daysOfStock).slice(0,3),o=t.filter(a=>a.recommendedOrderQty>0).reduce((a,i)=>a+i.recommendedOrderQty,0);return e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6 space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"ðŸ’¡ Recomendaciones EstratÃ©gicas"}),x.length>0&&e.jsxs("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸš¨"}),e.jsx("h4",{className:"text-lg font-semibold text-red-400",children:"AcciÃ³n Urgente Requerida"})]}),e.jsx("div",{className:"space-y-2",children:x.map((a,i)=>e.jsx("div",{className:"bg-neutral-900/50 rounded-lg p-3 border border-red-800/30",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:a.productName}),e.jsxs("div",{className:"text-sm text-red-400 mt-1",children:["Stock actual: ",a.currentStock.toFixed(0)," unidades (",a.daysOfStock," dÃ­as)"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-neutral-400",children:"Ordenar"}),e.jsxs("div",{className:"text-lg font-bold text-yellow-400",children:[a.recommendedOrderQty.toFixed(0)," unidades"]})]})]})},i))}),e.jsx("div",{className:"pt-2 border-t border-red-800/30",children:e.jsx("div",{className:"text-sm text-red-300",children:"âš ï¸ Estos productos necesitan reposiciÃ³n inmediata para evitar quiebres de stock"})})]}),d.length>0&&e.jsxs("div",{className:"bg-green-900/20 border border-green-800 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ“ˆ"}),e.jsx("h4",{className:"text-lg font-semibold text-green-400",children:"Productos con Demanda Creciente"})]}),e.jsx("div",{className:"space-y-2",children:d.map((a,i)=>e.jsxs("div",{className:"flex justify-between items-center bg-neutral-900/50 rounded-lg p-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:a.productName}),e.jsxs("div",{className:"text-sm text-green-400 mt-1",children:["Demanda predicha: ",a.predictedDemand.toFixed(0)," unidades (â†—ï¸ Aumentando)"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-neutral-400",children:"Promedio diario"}),e.jsx("div",{className:"text-white font-semibold",children:a.historicalAverage.toFixed(1)})]})]},i))}),e.jsx("div",{className:"pt-2 border-t border-green-800/30",children:e.jsx("div",{className:"text-sm text-green-300",children:"ðŸ’¡ Considere aumentar niveles de stock de seguridad para estos productos"})})]}),l.length>0&&e.jsxs("div",{className:"bg-orange-900/20 border border-orange-800 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"âš ï¸"}),e.jsx("h4",{className:"text-lg font-semibold text-orange-400",children:"OptimizaciÃ³n de Inventario"})]}),e.jsx("div",{className:"space-y-2",children:l.map((a,i)=>e.jsxs("div",{className:"flex justify-between items-center bg-neutral-900/50 rounded-lg p-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:a.productName}),e.jsxs("div",{className:"text-sm text-orange-400 mt-1",children:["Stock excesivo: ",a.daysOfStock," dÃ­as de inventario"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-neutral-400",children:"Stock actual"}),e.jsx("div",{className:"text-white font-semibold",children:a.currentStock.toFixed(0)})]})]},i))}),e.jsx("div",{className:"pt-2 border-t border-orange-800/30",children:e.jsx("div",{className:"text-sm text-orange-300",children:"ðŸ’¡ EvalÃºe promociones o redistribuciÃ³n para optimizar capital de trabajo"})})]}),o>0&&e.jsx("div",{className:"bg-blue-900/20 border border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ›’"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-400",children:"Orden de Compra Sugerida"}),e.jsx("div",{className:"text-sm text-neutral-400 mt-1",children:"Total de unidades a ordenar"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:o.toFixed(0)}),e.jsx("div",{className:"text-sm text-neutral-400",children:"unidades"})]})]})}),e.jsxs("div",{className:"bg-neutral-800/50 border border-neutral-700 rounded-lg p-4 space-y-2",children:[e.jsxs("h4",{className:"font-semibold text-white flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“‹"}),"Mejores PrÃ¡cticas de GestiÃ³n Predictiva"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-neutral-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5",children:"âœ“"}),e.jsx("span",{children:"Revisar pronÃ³sticos semanalmente para ajustar niveles de stock"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5",children:"âœ“"}),e.jsx("span",{children:"Priorizar reposiciÃ³n de productos con menos de 15 dÃ­as de inventario"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5",children:"âœ“"}),e.jsx("span",{children:"Considerar estacionalidad y eventos especiales en planificaciÃ³n"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5",children:"âœ“"}),e.jsx("span",{children:"Validar precisiÃ³n del modelo comparando pronÃ³sticos con demanda real"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5",children:"âœ“"}),e.jsx("span",{children:"Optimizar frecuencia de pedidos para productos de alta rotaciÃ³n"})]})]})]})]})}const G=10;function et(t){const s=Number(t);return Number.isFinite(s)?`$${s.toLocaleString("es-CL",{maximumFractionDigits:0})}`:"$0"}function mt(){const t=J(),s=X(),[x,d]=N.useState("lots"),[l,o]=N.useState(!1),[a,i]=N.useState(!1),[h,m]=N.useState(!1),[p,c]=N.useState(null),[g,n]=N.useState(null),r=C({queryKey:["products",{view:"inventory"}],queryFn:()=>A({size:200,status:"all"})}),f=C({queryKey:["inventory","settings"],queryFn:xe});N.useEffect(()=>{if(f.data){const w=Number(f.data.lowStockThreshold??0);if(Number.isFinite(w)&&w>0){g===null&&n(w);return}}!f.isLoading&&g===null&&n(G)},[f.data,f.isLoading,g]);const j=C({queryKey:["inventory","summary"],queryFn:D}),v=C({queryKey:["inventory","alerts",g],enabled:g!==null,queryFn:()=>he(g??void 0)}),b=()=>{t.invalidateQueries({queryKey:["inventory","summary"]}),t.invalidateQueries({queryKey:["inventory","alerts"]}),t.invalidateQueries({queryKey:["products"],exact:!1}),o(!1)},S=w=>{t.invalidateQueries({queryKey:["products"],exact:!1}),c(w),m(!1)};N.useMemo(()=>new Map((r.data?.content??[]).map(w=>[w.id,w])),[r.data]);const u=j.data;et(u?.totalValue??0);const y=u?.activeProducts??0,P=u?.lowStockAlerts??v.data?.length??0;u?.lowStockThreshold;const k=w=>{i(!1),c(w)},te=()=>{c(null)};return e.jsxs("div",{className:"page-section",children:[e.jsx(be,{title:"Inventario",description:"Visibiliza catÃ¡logo, lotes y alertas de stock para garantizar disponibilidad.",actions:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn ghost",onClick:()=>s("/app/inventory/movements"),children:"ðŸ“‹ Ver movimientos"}),e.jsx("button",{className:"btn ghost",onClick:()=>i(!0),children:"ðŸ“¦ CatÃ¡logo de productos"}),e.jsx("button",{className:"btn",onClick:()=>m(!0),children:"+ Nuevo Producto"}),e.jsx("button",{className:"btn",onClick:()=>o(!0),children:"+ Ajuste de stock"})]})}),!j.isLoading&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P>5&&e.jsxs("div",{className:"bg-red-950 border border-red-800 rounded-lg p-3 text-red-400 text-sm",children:["ðŸ”´ ",e.jsx("strong",{children:"CrÃ­tico:"})," ",P," productos con stock bajo - requiere atenciÃ³n inmediata"]}),y===0&&e.jsxs("div",{className:"bg-yellow-950 border border-yellow-800 rounded-lg p-3 text-yellow-400 text-sm",children:["âš ï¸ ",e.jsx("strong",{children:"Advertencia:"})," No hay productos activos en el inventario"]})]}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{className:"text-neutral-100",style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1rem"},children:"ðŸ“Š KPIs de Inventario"}),e.jsx(_e,{})]}),e.jsx("div",{style:{marginBottom:"2rem"},children:e.jsx(We,{})}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{className:"text-neutral-100",style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1rem"},children:"ðŸŽ¯ AnÃ¡lisis ABC de Inventario"}),e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsx(He,{})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-5",children:[e.jsx(Ge,{}),e.jsx(Ye,{})]})]}),e.jsxs("div",{style:{marginBottom:"2rem",marginTop:"2rem"},children:[e.jsx("h2",{className:"text-neutral-100",style:{fontSize:"1.5rem",fontWeight:"600",marginBottom:"1rem"},children:"ðŸ“ˆ PronÃ³stico de Demanda e Inteligencia Predictiva"}),e.jsx("div",{style:{marginBottom:"1.25rem"},children:e.jsx(Je,{})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-5",children:[e.jsx(Xe,{}),e.jsx(Ze,{})]})]}),e.jsxs("section",{className:"responsive-grid",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Operaciones logÃ­sticas"}),e.jsx("p",{className:"muted small",children:"Visualiza lotes, asigna ubicaciones y gestiona centros logÃ­sticos desde un solo lugar."})]}),e.jsxs("div",{className:"inline-actions",children:[e.jsx("button",{className:`btn ghost${x==="lots"?" active":""}`,type:"button",onClick:()=>d("lots"),children:"Lotes"}),e.jsx("button",{className:`btn ghost${x==="locations"?" active":""}`,type:"button",onClick:()=>d("locations"),children:"Ubicaciones"})]})]})}),e.jsx("div",{style:{gridColumn:"1 / -1"},children:x==="lots"?e.jsx(_,{}):e.jsx(pe,{})})]}),e.jsxs("div",{style:{marginBottom:"2rem",marginTop:"2rem"},children:[e.jsx("h2",{className:"text-neutral-100",style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1rem"},children:"ðŸ“Š AnÃ¡lisis de Inventario"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-5",children:[e.jsx(ze,{}),e.jsx(Ke,{})]})]}),e.jsx(Re,{open:h,product:null,onClose:()=>m(!1),onSaved:S}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{className:"text-neutral-100",style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1rem"},children:"âš™ï¸ GestiÃ³n Operativa"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-5",children:[e.jsx(Qe,{}),e.jsx(Ve,{})]})]}),e.jsxs("section",{className:"responsive-grid",style:{marginTop:"2rem",gap:"1rem"},children:[e.jsx(_,{}),e.jsx(Se,{})]}),e.jsx(Ue,{}),e.jsx(we,{open:l,onClose:()=>o(!1),onApplied:b}),e.jsx(Ee,{open:a,onClose:()=>i(!1),onSelectProduct:k}),e.jsx(Be,{open:!!p,product:p,onClose:te})]})}export{mt as default};
