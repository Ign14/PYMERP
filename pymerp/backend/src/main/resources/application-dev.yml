spring:
  datasource:
    url: "jdbc:postgresql://${POSTGRES_HOST:localhost}:${POSTGRES_PORT:55432}/${POSTGRES_DB:pymes}"
    driver-class-name: org.postgresql.Driver
    username: ${POSTGRES_USER:pymes}
    password: ${POSTGRES_PASSWORD:pymes}
    hikari:
      maximum-pool-size: 10
      minimum-idle: 2
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
  jpa:
    generate-ddl: false
    hibernate:
      ddl-auto: validate
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        use_sql_comments: true
    show-sql: true
  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
  h2:
    console:
      enabled: false
  mail:
    host: ${MAIL_HOST:localhost}
    port: ${MAIL_PORT:1025}

billing:
  crypto:
    secret: ${BILLING_CRYPTO_SECRET:MDEyMzQ1Njc4OUFCQ0RFRjAxMjM0NTY3ODlBQkNERUY=}
  webhook:
    secret: ${BILLING_WEBHOOK_SECRET:dev-webhook-secret}
    tolerance: PT5M
  offline:
    enabled: true
    legend: "Emitido en contingencia; sujeto a validaci√≥n"
    retry:
      maxAttempts: 5
      backoffMs: 15000
  pdf:
    documents-base-url: ${BILLING_DOCUMENTS_BASE_URL:http://localhost:8081/api/v1}
    branding:
      primary-color: "#1f2937"
      accent-color: "#2563eb"
      text-color: "#111827"
      table-header-color: "#e5e7eb"

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: when_authorized
  prometheus:
    metrics:
      export:
        enabled: true
  metrics:
    tags:
      application: pymerp-backend
    distribution:
      percentiles-histogram:
        http.server.requests: true
  health:
    redis:
      enabled: false
app:
  security:
    jwt:
      oidc-enabled: ${APP_SECURITY_JWT_OIDC_ENABLED:true}
    secrets-validation:
      enabled: false  # Disabled for dev to allow default secrets
    captcha:
      enabled: ${CAPTCHA_ENABLED:false}
      min-operand: 2
      max-operand: 10

storage:
  s3:
    bucket: ${STORAGE_S3_BUCKET:dev-change-me-bucket}
    access-key: ${STORAGE_S3_ACCESS_KEY:DEVACCESSKEY}
    secret-key: ${STORAGE_S3_SECRET_KEY:DEVSECRETKEY}
    region: ${STORAGE_S3_REGION:us-east-1}

webhooks:
  hmac:
    secret: ${WEBHOOKS_HMAC_SECRET:DEV_CHANGE_ME_HMAC_SECRET}
